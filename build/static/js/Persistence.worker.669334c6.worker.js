!function(r){var n={};function e(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return r[t].call(i.exports,i,i.exports,e),i.l=!0,i.exports}e.m=r,e.c=n,e.d=function(r,n,t){e.o(r,n)||Object.defineProperty(r,n,{enumerable:!0,get:t})},e.r=function(r){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},e.t=function(r,n){if(1&n&&(r=e(r)),8&n)return r;if(4&n&&"object"===typeof r&&r&&r.__esModule)return r;var t=Object.create(null);if(e.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:r}),2&n&&"string"!=typeof r)for(var i in r)e.d(t,i,function(n){return r[n]}.bind(null,i));return t},e.n=function(r){var n=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(n,"a",n),n},e.o=function(r,n){return Object.prototype.hasOwnProperty.call(r,n)},e.p="/",e(e.s=2)}([function(module,exports,__webpack_require__){"use strict";(function(global){var numeric=exports;"undefined"!==typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(r,n){var e,t,i;for("undefined"===typeof n&&(n=15),t=.5,e=new Date;;){for(i=t*=2;i>3;i-=4)r(),r(),r(),r();for(;i>0;)r(),i--;if(new Date-e>n)break}for(i=t;i>3;i-=4)r(),r(),r(),r();for(;i>0;)r(),i--;return 1e3*(3*t-1)/(new Date-e)},numeric._myIndexOf=function(r){var n,e=this.length;for(n=0;n<e;++n)if(this[n]===r)return n;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(r){function n(r){if(0===r)return"0";if(isNaN(r))return"NaN";if(r<0)return"-"+n(-r);if(isFinite(r)){var e=Math.floor(Math.log(r)/Math.log(10)),t=r/Math.pow(10,e),i=t.toPrecision(numeric.precision);return 10===parseFloat(i)&&(e++,i=(t=1).toPrecision(numeric.precision)),parseFloat(i).toString()+"e"+e.toString()}return"Infinity"}var e=[];return function r(t){var i;if("undefined"===typeof t)return e.push(Array(numeric.precision+8).join(" ")),!1;if("string"===typeof t)return e.push('"'+t+'"'),!1;if("boolean"===typeof t)return e.push(t.toString()),!1;if("number"===typeof t){var o=n(t),u=t.toPrecision(numeric.precision),c=parseFloat(t.toString()).toString(),a=[o,u,c,parseFloat(u).toString(),parseFloat(c).toString()];for(i=1;i<a.length;i++)a[i].length<o.length&&(o=a[i]);return e.push(Array(numeric.precision+8-o.length).join(" ")+o),!1}if(null===t)return e.push("null"),!1;if("function"===typeof t){e.push(t.toString());var f=!1;for(i in t)t.hasOwnProperty(i)&&(f?e.push(",\n"):e.push("\n{"),f=!0,e.push(i),e.push(": \n"),r(t[i]));return f&&e.push("}\n"),!0}if(t instanceof Array){if(t.length>numeric.largeArray)return e.push("...Large Array..."),!0;f=!1;for(e.push("["),i=0;i<t.length;i++)i>0&&(e.push(","),f&&e.push("\n ")),f=r(t[i]);return e.push("]"),!0}for(i in e.push("{"),f=!1,t)t.hasOwnProperty(i)&&(f&&e.push(",\n"),f=!0,e.push(i),e.push(": \n"),r(t[i]));return e.push("}"),!0}(r),e.join("")},numeric.parseDate=function(r){return function r(n){if("string"===typeof n)return Date.parse(n.replace(/-/g,"/"));if(!(n instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var e,t=[];for(e=0;e<n.length;e++)t[e]=r(n[e]);return t}(r)},numeric.parseFloat=function(r){return function r(n){if("string"===typeof n)return parseFloat(n);if(!(n instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var e,t=[];for(e=0;e<n.length;e++)t[e]=r(n[e]);return t}(r)},numeric.parseCSV=function(r){var n,e,t,i=r.split("\n"),o=[],u=/(([^'",]*)|('[^']*')|("[^"]*")),/g,c=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,a=0;for(e=0;e<i.length;e++){var f,s=(i[e]+",").match(u);if(s.length>0){for(o[a]=[],n=0;n<s.length;n++)f=(t=s[n]).substr(0,t.length-1),c.test(f)?o[a][n]=parseFloat(f):o[a][n]=f;a++}}return o},numeric.toCSV=function(r){var n,e,t,i,o,u=numeric.dim(r);for(t=u[0],u[1],o=[],n=0;n<t;n++){for(i=[],e=0;e<t;e++)i[e]=r[n][e].toString();o[n]=i.join(", ")}return o.join("\n")+"\n"},numeric.getURL=function(r){var n=new XMLHttpRequest;return n.open("GET",r,!1),n.send(),n},numeric.imageURL=function(r){function n(r,n,e){"undefined"===typeof n&&(n=0),"undefined"===typeof e&&(e=r.length);var t,i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o=-1;r.length;for(t=n;t<e;t++)o=o>>>8^i[255&(o^r[t])];return-1^o}var e,t,i,o,u,c,a,f,s,m,h=r[0].length,l=r[0][0].length,p=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,l>>24&255,l>>16&255,l>>8&255,255&l,h>>24&255,h>>16&255,h>>8&255,255&h,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(m=n(p,12,29),p[29]=m>>24&255,p[30]=m>>16&255,p[31]=m>>8&255,p[32]=255&m,e=1,t=0,a=0;a<h;a++){for(a<h-1?p.push(0):p.push(1),u=3*l+1+(0===a)&255,c=3*l+1+(0===a)>>8&255,p.push(u),p.push(c),p.push(255&~u),p.push(255&~c),0===a&&p.push(0),f=0;f<l;f++)for(i=0;i<3;i++)t=(t+(e=(e+(u=(u=r[i][a][f])>255?255:u<0?0:Math.round(u)))%65521))%65521,p.push(u);p.push(0)}return s=(t<<16)+e,p.push(s>>24&255),p.push(s>>16&255),p.push(s>>8&255),p.push(255&s),o=p.length-41,p[33]=o>>24&255,p[34]=o>>16&255,p[35]=o>>8&255,p[36]=255&o,m=n(p,37),p.push(m>>24&255),p.push(m>>16&255),p.push(m>>8&255),p.push(255&m),p.push(0),p.push(0),p.push(0),p.push(0),p.push(73),p.push(69),p.push(78),p.push(68),p.push(174),p.push(66),p.push(96),p.push(130),"data:image/png;base64,"+function(r){var n,e,t,i,o,u,c,a=r.length,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="";for(n=0;n<a;n+=3)o=((3&(e=r[n]))<<4)+((t=r[n+1])>>4),u=((15&t)<<2)+((i=r[n+2])>>6),c=63&i,n+1>=a?u=c=64:n+2>=a&&(c=64),s+=f.charAt(e>>2)+f.charAt(o)+f.charAt(u)+f.charAt(c);return s}(p)},numeric._dim=function(r){for(var n=[];"object"===typeof r;)n.push(r.length),r=r[0];return n},numeric.dim=function(r){var n;return"object"===typeof r?"object"===typeof(n=r[0])?"object"===typeof n[0]?numeric._dim(r):[r.length,n.length]:[r.length]:[]},numeric.mapreduce=function(r,n){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+n+';\nif(typeof x === "number") { var xi = x; '+r+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+r+";\n    xi = x[i-1];\n    "+r+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+r+"\n}\nreturn accum;")},numeric.mapreduce2=function(r,n){return Function("x","var n = x.length;\nvar i,xi;\n"+n+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+r+";\n}\nreturn accum;")},numeric.same=function r(n,e){var t,i;if(!(n instanceof Array)||!(e instanceof Array))return!1;if((i=n.length)!==e.length)return!1;for(t=0;t<i;t++)if(n[t]!==e[t]){if("object"!==typeof n[t])return!1;if(!r(n[t],e[t]))return!1}return!0},numeric.rep=function(r,n,e){"undefined"===typeof e&&(e=0);var t,i=r[e],o=Array(i);if(e===r.length-1){for(t=i-2;t>=0;t-=2)o[t+1]=n,o[t]=n;return-1===t&&(o[0]=n),o}for(t=i-1;t>=0;t--)o[t]=numeric.rep(r,n,e+1);return o},numeric.dotMMsmall=function(r,n){var e,t,i,o,u,c,a,f,s,m,h;for(o=r.length,u=n.length,c=n[0].length,a=Array(o),e=o-1;e>=0;e--){for(f=Array(c),s=r[e],i=c-1;i>=0;i--){for(m=s[u-1]*n[u-1][i],t=u-2;t>=1;t-=2)h=t-1,m+=s[t]*n[t][i]+s[h]*n[h][i];0===t&&(m+=s[0]*n[0][i]),f[i]=m}a[e]=f}return a},numeric._getCol=function(r,n,e){var t;for(t=r.length-1;t>0;--t)e[t]=r[t][n],e[--t]=r[t][n];0===t&&(e[0]=r[0][n])},numeric.dotMMbig=function(r,n){var e,t,i,o=numeric._getCol,u=n.length,c=Array(u),a=r.length,f=n[0].length,s=new Array(a),m=numeric.dotVV;for(--u,t=--a;-1!==t;--t)s[t]=Array(f);for(t=--f;-1!==t;--t)for(o(n,t,c),i=a;-1!==i;--i)0,e=r[i],s[i][t]=m(e,c);return s},numeric.dotMV=function(r,n){var e,t=r.length,i=(n.length,Array(t)),o=numeric.dotVV;for(e=t-1;e>=0;e--)i[e]=o(r[e],n);return i},numeric.dotVM=function(r,n){var e,t,i,o,u,c,a;for(i=r.length,o=n[0].length,u=Array(o),t=o-1;t>=0;t--){for(c=r[i-1]*n[i-1][t],e=i-2;e>=1;e-=2)a=e-1,c+=r[e]*n[e][t]+r[a]*n[a][t];0===e&&(c+=r[0]*n[0][t]),u[t]=c}return u},numeric.dotVV=function(r,n){var e,t,i=r.length,o=r[i-1]*n[i-1];for(e=i-2;e>=1;e-=2)t=e-1,o+=r[e]*n[e]+r[t]*n[t];return 0===e&&(o+=r[0]*n[0]),o},numeric.dot=function(r,n){var e=numeric.dim;switch(1e3*e(r).length+e(n).length){case 2002:return n.length<10?numeric.dotMMsmall(r,n):numeric.dotMMbig(r,n);case 2001:return numeric.dotMV(r,n);case 1002:return numeric.dotVM(r,n);case 1001:return numeric.dotVV(r,n);case 1e3:return numeric.mulVS(r,n);case 1:return numeric.mulSV(r,n);case 0:return r*n;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(r){var n,e,t,i,o=r.length,u=Array(o);for(n=o-1;n>=0;n--){for(i=Array(o),e=n+2,t=o-1;t>=e;t-=2)i[t]=0,i[t-1]=0;for(t>n&&(i[t]=0),i[n]=r[n],t=n-1;t>=1;t-=2)i[t]=0,i[t-1]=0;0===t&&(i[0]=0),u[n]=i}return u},numeric.getDiag=function(r){var n,e=Math.min(r.length,r[0].length),t=Array(e);for(n=e-1;n>=1;--n)t[n]=r[n][n],t[--n]=r[n][n];return 0===n&&(t[0]=r[0][0]),t},numeric.identity=function(r){return numeric.diag(numeric.rep([r],1))},numeric.pointwise=function(r,n,e){"undefined"===typeof e&&(e="");var t,i,o=[],u=/\[i\]$/,c="",a=!1;for(t=0;t<r.length;t++)u.test(r[t])?c=i=r[t].substring(0,r[t].length-3):i=r[t],"ret"===i&&(a=!0),o.push(i);return o[r.length]="_s",o[r.length+1]="_k",o[r.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+c+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(a?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+r.join(",")+",_s,_k+1);\n    return ret;\n}\n"+e+"\nfor(i=_n-1;i!==-1;--i) {\n    "+n+"\n}\nreturn ret;",Function.apply(null,o)},numeric.pointwise2=function(r,n,e){"undefined"===typeof e&&(e="");var t,i,o=[],u=/\[i\]$/,c="",a=!1;for(t=0;t<r.length;t++)u.test(r[t])?c=i=r[t].substring(0,r[t].length-3):i=r[t],"ret"===i&&(a=!0),o.push(i);return o[r.length]="var _n = "+c+".length;\nvar i"+(a?"":", ret = Array(_n)")+";\n"+e+"\nfor(i=_n-1;i!==-1;--i) {\n"+n+"\n}\nreturn ret;",Function.apply(null,o)},numeric._biforeach=function r(n,e,t,i,o){var u;if(i!==t.length-1)for(u=t[i]-1;u>=0;u--)r("object"===typeof n?n[u]:n,"object"===typeof e?e[u]:e,t,i+1,o);else o(n,e)},numeric._biforeach2=function r(n,e,t,i,o){if(i===t.length-1)return o(n,e);var u,c=t[i],a=Array(c);for(u=c-1;u>=0;--u)a[u]=r("object"===typeof n?n[u]:n,"object"===typeof e?e[u]:e,t,i+1,o);return a},numeric._foreach=function r(n,e,t,i){var o;if(t!==e.length-1)for(o=e[t]-1;o>=0;o--)r(n[o],e,t+1,i);else i(n)},numeric._foreach2=function r(n,e,t,i){if(t===e.length-1)return i(n);var o,u=e[t],c=Array(u);for(o=u-1;o>=0;o--)c[o]=r(n[o],e,t+1,i);return c},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var r,n;for(r=0;r<numeric.mathfuns2.length;++r)n=numeric.mathfuns2[r],numeric.ops2[n]=n;for(r in numeric.ops2)if(numeric.ops2.hasOwnProperty(r)){n=numeric.ops2[r];var e,t,i="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,r)?(i="var "+n+" = Math."+n+";\n",e=function(r,e,t){return r+" = "+n+"("+e+","+t+")"},t=function(r,e){return r+" = "+n+"("+r+","+e+")"}):(e=function(r,e,t){return r+" = "+e+" "+n+" "+t},t=numeric.opseq.hasOwnProperty(r+"eq")?function(r,e){return r+" "+n+"= "+e}:function(r,e){return r+" = "+r+" "+n+" "+e}),numeric[r+"VV"]=numeric.pointwise2(["x[i]","y[i]"],e("ret[i]","x[i]","y[i]"),i),numeric[r+"SV"]=numeric.pointwise2(["x","y[i]"],e("ret[i]","x","y[i]"),i),numeric[r+"VS"]=numeric.pointwise2(["x[i]","y"],e("ret[i]","x[i]","y"),i),numeric[r]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+r+"VV, VS = numeric."+r+"VS, SV = numeric."+r+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+t("x","y")+"\n}\nreturn x;\n"),numeric[n]=numeric[r],numeric[r+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],t("ret[i]","x[i]"),i),numeric[r+"eqS"]=numeric.pointwise2(["ret[i]","x"],t("ret[i]","x"),i),numeric[r+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+r+"eqV, S = numeric."+r+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(r=0;r<numeric.mathfuns2.length;++r)n=numeric.mathfuns2[r],delete numeric.ops2[n];for(r=0;r<numeric.mathfuns.length;++r)n=numeric.mathfuns[r],numeric.ops1[n]=n;for(r in numeric.ops1)numeric.ops1.hasOwnProperty(r)&&(i="",n=numeric.ops1[r],-1!==numeric.myIndexOf.call(numeric.mathfuns,r)&&Math.hasOwnProperty(n)&&(i="var "+n+" = Math."+n+";\n"),numeric[r+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+n+"(ret[i]);",i),numeric[r+"eq"]=Function("x",'if(typeof x !== "object") return '+n+"x\nvar i;\nvar V = numeric."+r+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[r+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+n+"(x[i]);",i),numeric[r]=Function("x",'if(typeof x !== "object") return '+n+"(x)\nvar i;\nvar V = numeric."+r+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(r=0;r<numeric.mathfuns.length;++r)n=numeric.mathfuns[r],delete numeric.ops1[n];for(r in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(r)&&(n=numeric.mapreducers[r],numeric[r+"V"]=numeric.mapreduce2(n[0],n[1]),numeric[r]=Function("x","s","k",n[1]+'if(typeof x !== "object") {    xi = x;\n'+n[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+r+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+n[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(r,n){return"object"===typeof r?"object"===typeof n?numeric.truncVV(r,n):numeric.truncVS(r,n):"object"===typeof n?numeric.truncSV(r,n):Math.round(r/n)*n},numeric.inv=function(r){var n,e,t,i,o,u,c,a=numeric.dim(r),f=Math.abs,s=a[0],m=a[1],h=numeric.clone(r),l=numeric.identity(s);for(u=0;u<m;++u){var p=-1,y=-1;for(o=u;o!==s;++o)(c=f(h[o][u]))>y&&(p=o,y=c);for(e=h[p],h[p]=h[u],h[u]=e,i=l[p],l[p]=l[u],l[u]=i,r=e[u],c=u;c!==m;++c)e[c]/=r;for(c=m-1;-1!==c;--c)i[c]/=r;for(o=s-1;-1!==o;--o)if(o!==u){for(n=h[o],t=l[o],r=n[u],c=u+1;c!==m;++c)n[c]-=e[c]*r;for(c=m-1;c>0;--c)t[c]-=i[c]*r,t[--c]-=i[c]*r;0===c&&(t[0]-=i[0]*r)}}return l},numeric.det=function(r){var n=numeric.dim(r);if(2!==n.length||n[0]!==n[1])throw new Error("numeric: det() only works on square matrices");var e,t,i,o,u,c,a,f,s=n[0],m=1,h=numeric.clone(r);for(t=0;t<s-1;t++){for(i=t,e=t+1;e<s;e++)Math.abs(h[e][t])>Math.abs(h[i][t])&&(i=e);for(i!==t&&(a=h[i],h[i]=h[t],h[t]=a,m*=-1),o=h[t],e=t+1;e<s;e++){for(c=(u=h[e])[t]/o[t],i=t+1;i<s-1;i+=2)f=i+1,u[i]-=o[i]*c,u[f]-=o[f]*c;i!==s&&(u[i]-=o[i]*c)}if(0===o[t])return 0;m*=o[t]}return m*h[t][t]},numeric.transpose=function(r){var n,e,t,i,o,u=r.length,c=r[0].length,a=Array(c);for(e=0;e<c;e++)a[e]=Array(u);for(n=u-1;n>=1;n-=2){for(i=r[n],t=r[n-1],e=c-1;e>=1;--e)(o=a[e])[n]=i[e],o[n-1]=t[e],(o=a[--e])[n]=i[e],o[n-1]=t[e];0===e&&((o=a[0])[n]=i[0],o[n-1]=t[0])}if(0===n){for(t=r[0],e=c-1;e>=1;--e)a[e][0]=t[e],a[--e][0]=t[e];0===e&&(a[0][0]=t[0])}return a},numeric.negtranspose=function(r){var n,e,t,i,o,u=r.length,c=r[0].length,a=Array(c);for(e=0;e<c;e++)a[e]=Array(u);for(n=u-1;n>=1;n-=2){for(i=r[n],t=r[n-1],e=c-1;e>=1;--e)(o=a[e])[n]=-i[e],o[n-1]=-t[e],(o=a[--e])[n]=-i[e],o[n-1]=-t[e];0===e&&((o=a[0])[n]=-i[0],o[n-1]=-t[0])}if(0===n){for(t=r[0],e=c-1;e>=1;--e)a[e][0]=-t[e],a[--e][0]=-t[e];0===e&&(a[0][0]=-t[0])}return a},numeric._random=function r(n,e){var t,i,o=n[e],u=Array(o);if(e===n.length-1){for(i=Math.random,t=o-1;t>=1;t-=2)u[t]=i(),u[t-1]=i();return 0===t&&(u[0]=i()),u}for(t=o-1;t>=0;t--)u[t]=r(n,e+1);return u},numeric.random=function(r){return numeric._random(r,0)},numeric.norm2=function(r){return Math.sqrt(numeric.norm2Squared(r))},numeric.linspace=function(r,n,e){if("undefined"===typeof e&&(e=Math.max(Math.round(n-r)+1,1)),e<2)return 1===e?[r]:[];var t,i=Array(e);for(t=--e;t>=0;t--)i[t]=(t*n+(e-t)*r)/e;return i},numeric.getBlock=function(r,n,e){var t=numeric.dim(r);return function r(i,o){var u,c=n[o],a=e[o]-c,f=Array(a);if(o===t.length-1){for(u=a;u>=0;u--)f[u]=i[u+c];return f}for(u=a;u>=0;u--)f[u]=r(i[u+c],o+1);return f}(r,0)},numeric.setBlock=function(r,n,e,t){var i=numeric.dim(r);return function r(t,o,u){var c,a=n[u],f=e[u]-a;if(u===i.length-1)for(c=f;c>=0;c--)t[c+a]=o[c];for(c=f;c>=0;c--)r(t[c+a],o[c],u+1)}(r,t,0),r},numeric.getRange=function(r,n,e){var t,i,o,u,c=n.length,a=e.length,f=Array(c);for(t=c-1;-1!==t;--t)for(f[t]=Array(a),o=f[t],u=r[n[t]],i=a-1;-1!==i;--i)o[i]=u[e[i]];return f},numeric.blockMatrix=function(r){var n=numeric.dim(r);if(n.length<4)return numeric.blockMatrix([r]);var e,t,i,o,u,c=n[0],a=n[1];for(e=0,t=0,i=0;i<c;++i)e+=r[i][0].length;for(o=0;o<a;++o)t+=r[0][o][0].length;var f=Array(e);for(i=0;i<e;++i)f[i]=Array(t);var s,m,h,l,p,y=0;for(i=0;i<c;++i){for(s=t,o=a-1;-1!==o;--o)for(s-=(u=r[i][o])[0].length,h=u.length-1;-1!==h;--h)for(p=u[h],m=f[y+h],l=p.length-1;-1!==l;--l)m[s+l]=p[l];y+=r[i][0].length}return f},numeric.tensor=function(r,n){if("number"===typeof r||"number"===typeof n)return numeric.mul(r,n);var e=numeric.dim(r),t=numeric.dim(n);if(1!==e.length||1!==t.length)throw new Error("numeric: tensor product is only defined for vectors");var i,o,u,c,a=e[0],f=t[0],s=Array(a);for(o=a-1;o>=0;o--){for(i=Array(f),c=r[o],u=f-1;u>=3;--u)i[u]=c*n[u],i[--u]=c*n[u],i[--u]=c*n[u],i[--u]=c*n[u];for(;u>=0;)i[u]=c*n[u],--u;s[o]=i}return s},numeric.T=function(r,n){this.x=r,this.y=n},numeric.t=function(r,n){return new numeric.T(r,n)},numeric.Tbinop=function(r,n,e,t,i){var o;numeric.indexOf;if("string"!==typeof i)for(o in i="",numeric)numeric.hasOwnProperty(o)&&(r.indexOf(o)>=0||n.indexOf(o)>=0||e.indexOf(o)>=0||t.indexOf(o)>=0)&&o.length>1&&(i+="var "+o+" = numeric."+o+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+i+"\nif(x.y) {  if(y.y) {    return new numeric.T("+t+");\n  }\n  return new numeric.T("+e+");\n}\nif(y.y) {\n  return new numeric.T("+n+");\n}\nreturn new numeric.T("+r+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var r=numeric.mul,n=numeric.div;if(this.y){var e=numeric.add(r(this.x,this.x),r(this.y,this.y));return new numeric.T(n(this.x,e),n(numeric.neg(this.y),e))}return new T(n(1,this.x))},numeric.T.prototype.div=function(r){if(r instanceof numeric.T||(r=new numeric.T(r)),r.y)return this.mul(r.reciprocal());var n=numeric.div;return this.y?new numeric.T(n(this.x,r.x),n(this.y,r.x)):new numeric.T(n(this.x,r.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var r=numeric.transpose,n=this.x,e=this.y;return e?new numeric.T(r(n),r(e)):new numeric.T(r(n))},numeric.T.prototype.transjugate=function(){var r=numeric.transpose,n=this.x,e=this.y;return e?new numeric.T(r(n),numeric.negtranspose(e)):new numeric.T(r(n))},numeric.Tunop=function(r,n,e){return"string"!==typeof e&&(e=""),Function("var x = this;\n"+e+"\nif(x.y) {  "+n+";\n}\n"+r+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var r=this;if("undefined"===typeof r.y)return new numeric.T(numeric.inv(r.x));var n,e,t,i,o,u,c,a,f,s,m,h,l,p,y,g,d,v,A=r.x.length,x=numeric.identity(A),M=numeric.rep([A,A],0),b=numeric.clone(r.x),T=numeric.clone(r.y);for(f=0;f<A;f++){for(h=(p=b[f][f])*p+(y=T[f][f])*y,m=f,s=f+1;s<A;s++)(l=(p=b[s][f])*p+(y=T[s][f])*y)>h&&(m=s,h=l);for(m!==f&&(v=b[f],b[f]=b[m],b[m]=v,v=T[f],T[f]=T[m],T[m]=v,v=x[f],x[f]=x[m],x[m]=v,v=M[f],M[f]=M[m],M[m]=v),n=b[f],e=T[f],o=x[f],u=M[f],p=n[f],y=e[f],s=f+1;s<A;s++)g=n[s],d=e[s],n[s]=(g*p+d*y)/h,e[s]=(d*p-g*y)/h;for(s=0;s<A;s++)g=o[s],d=u[s],o[s]=(g*p+d*y)/h,u[s]=(d*p-g*y)/h;for(s=f+1;s<A;s++){for(t=b[s],i=T[s],c=x[s],a=M[s],p=t[f],y=i[f],m=f+1;m<A;m++)g=n[m],d=e[m],t[m]-=g*p-d*y,i[m]-=d*p+g*y;for(m=0;m<A;m++)g=o[m],d=u[m],c[m]-=g*p-d*y,a[m]-=d*p+g*y}}for(f=A-1;f>0;f--)for(o=x[f],u=M[f],s=f-1;s>=0;s--)for(c=x[s],a=M[s],p=b[s][f],y=T[s][f],m=A-1;m>=0;m--)g=o[m],d=u[m],c[m]-=p*g-y*d,a[m]-=p*d+y*g;return new numeric.T(x,M)},numeric.T.prototype.get=function(r){var n,e=this.x,t=this.y,i=0,o=r.length;if(t){for(;i<o;)e=e[n=r[i]],t=t[n],i++;return new numeric.T(e,t)}for(;i<o;)e=e[n=r[i]],i++;return new numeric.T(e)},numeric.T.prototype.set=function(r,n){var e,t=this.x,i=this.y,o=0,u=r.length,c=n.x,a=n.y;if(0===u)return a?this.y=a:i&&(this.y=void 0),this.x=t,this;if(a){for(i||(i=numeric.rep(numeric.dim(t),0),this.y=i);o<u-1;)t=t[e=r[o]],i=i[e],o++;return t[e=r[o]]=c,i[e]=a,this}if(i){for(;o<u-1;)t=t[e=r[o]],i=i[e],o++;return t[e=r[o]]=c,i[e]=c instanceof Array?numeric.rep(numeric.dim(c),0):0,this}for(;o<u-1;)t=t[e=r[o]],o++;return t[e=r[o]]=c,this},numeric.T.prototype.getRows=function(r,n){var e,t,i=n-r+1,o=Array(i),u=this.x,c=this.y;for(e=r;e<=n;e++)o[e-r]=u[e];if(c){for(t=Array(i),e=r;e<=n;e++)t[e-r]=c[e];return new numeric.T(o,t)}return new numeric.T(o)},numeric.T.prototype.setRows=function(r,n,e){var t,i=this.x,o=this.y,u=e.x,c=e.y;for(t=r;t<=n;t++)i[t]=u[t-r];if(c)for(o||(o=numeric.rep(numeric.dim(i),0),this.y=o),t=r;t<=n;t++)o[t]=c[t-r];else if(o)for(t=r;t<=n;t++)o[t]=numeric.rep([u[t-r].length],0);return this},numeric.T.prototype.getRow=function(r){var n=this.x,e=this.y;return e?new numeric.T(n[r],e[r]):new numeric.T(n[r])},numeric.T.prototype.setRow=function(r,n){var e=this.x,t=this.y,i=n.x,o=n.y;return e[r]=i,o?(t||(t=numeric.rep(numeric.dim(e),0),this.y=t),t[r]=o):t&&(t=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(r,n){var e=this.x,t=this.y,i=numeric.getBlock;return t?new numeric.T(i(e,r,n),i(t,r,n)):new numeric.T(i(e,r,n))},numeric.T.prototype.setBlock=function(r,n,e){e instanceof numeric.T||(e=new numeric.T(e));var t=this.x,i=this.y,o=numeric.setBlock,u=e.x,c=e.y;if(c)return i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),o(t,r,n,u),o(i,r,n,c),this;o(t,r,n,u),i&&o(i,r,n,numeric.rep(numeric.dim(u),0))},numeric.T.rep=function(r,n){var e=numeric.T;n instanceof e||(n=new e(n));var t=n.x,i=n.y,o=numeric.rep;return i?new e(o(r,t),o(r,i)):new e(o(r,t))},numeric.T.diag=function(r){r instanceof numeric.T||(r=new numeric.T(r));var n=r.x,e=r.y,t=numeric.diag;return e?new numeric.T(t(n),t(e)):new numeric.T(t(n))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(r){return new numeric.T(numeric.identity(r))},numeric.T.prototype.getDiag=function(){var r=numeric,n=this.x,e=this.y;return e?new r.T(r.getDiag(n),r.getDiag(e)):new r.T(r.getDiag(n))},numeric.house=function(r){var n=numeric.clone(r),e=(r[0]>=0?1:-1)*numeric.norm2(r);n[0]+=e;var t=numeric.norm2(n);if(0===t)throw new Error("eig: internal error");return numeric.div(n,t)},numeric.toUpperHessenberg=function(r){var n=numeric.dim(r);if(2!==n.length||n[0]!==n[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var e,t,i,o,u,c,a,f,s,m,h=n[0],l=numeric.clone(r),p=numeric.identity(h);for(t=0;t<h-2;t++){for(o=Array(h-t-1),e=t+1;e<h;e++)o[e-t-1]=l[e][t];if(numeric.norm2(o)>0){for(u=numeric.house(o),c=numeric.getBlock(l,[t+1,t],[h-1,h-1]),a=numeric.tensor(u,numeric.dot(u,c)),e=t+1;e<h;e++)for(f=l[e],s=a[e-t-1],i=t;i<h;i++)f[i]-=2*s[i-t];for(c=numeric.getBlock(l,[0,t+1],[h-1,h-1]),a=numeric.tensor(numeric.dot(c,u),u),e=0;e<h;e++)for(f=l[e],s=a[e],i=t+1;i<h;i++)f[i]-=2*s[i-t-1];for(c=Array(h-t-1),e=t+1;e<h;e++)c[e-t-1]=p[e];for(a=numeric.tensor(u,numeric.dot(u,c)),e=t+1;e<h;e++)for(m=p[e],s=a[e-t-1],i=0;i<h;i++)m[i]-=2*s[i]}}return{H:l,Q:p}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(r,n){"undefined"===typeof n&&(n=1e4),r=numeric.clone(r);numeric.clone(r);var e,t,i,o,u,c,a,f,s,m,h,l,p,y,g,d,v,A,x=numeric.dim(r)[0],M=numeric.identity(x);if(x<3)return{Q:M,B:[[0,x-1]]};var b=numeric.epsilon;for(A=0;A<n;A++){for(d=0;d<x-1;d++)if(Math.abs(r[d+1][d])<b*(Math.abs(r[d][d])+Math.abs(r[d+1][d+1]))){var T=numeric.QRFrancis(numeric.getBlock(r,[0,0],[d,d]),n),w=numeric.QRFrancis(numeric.getBlock(r,[d+1,d+1],[x-1,x-1]),n);for(l=Array(d+1),g=0;g<=d;g++)l[g]=M[g];for(p=numeric.dot(T.Q,l),g=0;g<=d;g++)M[g]=p[g];for(l=Array(x-d-1),g=d+1;g<x;g++)l[g-d-1]=M[g];for(p=numeric.dot(w.Q,l),g=d+1;g<x;g++)M[g]=p[g-d-1];return{Q:M,B:T.B.concat(numeric.add(w.B,d+1))}}var O,j,k;if(i=r[x-2][x-2],o=r[x-2][x-1],u=r[x-1][x-2],f=i+(c=r[x-1][x-1]),a=i*c-o*u,s=numeric.getBlock(r,[0,0],[2,2]),f*f>=4*a)O=.5*(f+Math.sqrt(f*f-4*a)),j=.5*(f-Math.sqrt(f*f-4*a)),s=numeric.add(numeric.sub(numeric.dot(s,s),numeric.mul(s,O+j)),numeric.diag(numeric.rep([3],O*j)));else s=numeric.add(numeric.sub(numeric.dot(s,s),numeric.mul(s,f)),numeric.diag(numeric.rep([3],a)));for(e=[s[0][0],s[1][0],s[2][0]],t=numeric.house(e),l=[r[0],r[1],r[2]],p=numeric.tensor(t,numeric.dot(t,l)),g=0;g<3;g++)for(h=r[g],y=p[g],v=0;v<x;v++)h[v]-=2*y[v];for(l=numeric.getBlock(r,[0,0],[x-1,2]),p=numeric.tensor(numeric.dot(l,t),t),g=0;g<x;g++)for(h=r[g],y=p[g],v=0;v<3;v++)h[v]-=2*y[v];for(l=[M[0],M[1],M[2]],p=numeric.tensor(t,numeric.dot(t,l)),g=0;g<3;g++)for(m=M[g],y=p[g],v=0;v<x;v++)m[v]-=2*y[v];for(d=0;d<x-2;d++){for(v=d;v<=d+1;v++)if(Math.abs(r[v+1][v])<b*(Math.abs(r[v][v])+Math.abs(r[v+1][v+1]))){T=numeric.QRFrancis(numeric.getBlock(r,[0,0],[v,v]),n),w=numeric.QRFrancis(numeric.getBlock(r,[v+1,v+1],[x-1,x-1]),n);for(l=Array(v+1),g=0;g<=v;g++)l[g]=M[g];for(p=numeric.dot(T.Q,l),g=0;g<=v;g++)M[g]=p[g];for(l=Array(x-v-1),g=v+1;g<x;g++)l[g-v-1]=M[g];for(p=numeric.dot(w.Q,l),g=v+1;g<x;g++)M[g]=p[g-v-1];return{Q:M,B:T.B.concat(numeric.add(w.B,v+1))}}for(k=Math.min(x-1,d+3),e=Array(k-d),g=d+1;g<=k;g++)e[g-d-1]=r[g][d];for(t=numeric.house(e),l=numeric.getBlock(r,[d+1,d],[k,x-1]),p=numeric.tensor(t,numeric.dot(t,l)),g=d+1;g<=k;g++)for(h=r[g],y=p[g-d-1],v=d;v<x;v++)h[v]-=2*y[v-d];for(l=numeric.getBlock(r,[0,d+1],[x-1,k]),p=numeric.tensor(numeric.dot(l,t),t),g=0;g<x;g++)for(h=r[g],y=p[g],v=d+1;v<=k;v++)h[v]-=2*y[v-d-1];for(l=Array(k-d),g=d+1;g<=k;g++)l[g-d-1]=M[g];for(p=numeric.tensor(t,numeric.dot(t,l)),g=d+1;g<=k;g++)for(m=M[g],y=p[g-d-1],v=0;v<x;v++)m[v]-=2*y[v]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(r,n){var e,t,i,o,u,c,a,f,s,m,h,l,p,y,g,d,v=numeric.toUpperHessenberg(r),A=numeric.QRFrancis(v.H,n),x=numeric.T,M=r.length,b=A.B,T=numeric.dot(A.Q,numeric.dot(v.H,numeric.transpose(A.Q))),w=new x(numeric.dot(A.Q,v.Q)),O=b.length,j=Math.sqrt;for(t=0;t<O;t++)if((e=b[t][0])===b[t][1]);else{if(o=e+1,u=T[e][e],c=T[e][o],a=T[o][e],f=T[o][o],0===c&&0===a)continue;(m=(s=-u-f)*s-4*(u*f-c*a))>=0?((g=(u-(h=s<0?-.5*(s-j(m)):-.5*(s+j(m))))*(u-h)+c*c)>(d=a*a+(f-h)*(f-h))?(p=(u-h)/(g=j(g)),y=c/g):(p=a/(d=j(d)),y=(f-h)/d),i=new x([[y,-p],[p,y]]),w.setRows(e,o,i.dot(w.getRows(e,o)))):(h=-.5*s,l=.5*j(-m),(g=(u-h)*(u-h)+c*c)>(d=a*a+(f-h)*(f-h))?(p=(u-h)/(g=j(g+l*l)),y=c/g,h=0,l/=g):(p=a/(d=j(d+l*l)),y=(f-h)/d,h=l/d,l=0),i=new x([[y,-p],[p,y]],[[h,l],[l,-h]]),w.setRows(e,o,i.dot(w.getRows(e,o))))}var k=w.dot(r).dot(w.transjugate()),S=(M=r.length,numeric.T.identity(M));for(o=0;o<M;o++)if(o>0)for(t=o-1;t>=0;t--){var _=k.get([t,t]),C=k.get([o,o]);numeric.neq(_.x,C.x)||numeric.neq(_.y,C.y)?(h=k.getRow(t).getBlock([t],[o-1]),l=S.getRow(o).getBlock([t],[o-1]),S.set([o,t],k.get([t,o]).neg().sub(h.dot(l)).div(_.sub(C)))):S.setRow(o,S.getRow(t))}for(o=0;o<M;o++)h=S.getRow(o),S.setRow(o,h.div(h.norm2()));return S=S.transpose(),S=w.transjugate().dot(S),{lambda:k.getDiag(),E:S}},numeric.ccsSparse=function(r){var n,e,t,i=r.length,o=[];for(e=i-1;-1!==e;--e)for(t in n=r[e]){for(t=parseInt(t);t>=o.length;)o[o.length]=0;0!==n[t]&&o[t]++}var u=o.length,c=Array(u+1);for(c[0]=0,e=0;e<u;++e)c[e+1]=c[e]+o[e];var a=Array(c[u]),f=Array(c[u]);for(e=i-1;-1!==e;--e)for(t in n=r[e])0!==n[t]&&(o[t]--,a[c[t]+o[t]]=e,f[c[t]+o[t]]=n[t]);return[c,a,f]},numeric.ccsFull=function(r){var n,e,t,i,o=r[0],u=r[1],c=r[2],a=numeric.ccsDim(r),f=a[0],s=a[1],m=numeric.rep([f,s],0);for(n=0;n<s;n++)for(t=o[n],i=o[n+1],e=t;e<i;++e)m[u[e]][n]=c[e];return m},numeric.ccsTSolve=function(r,n,e,t,i){var o,u,c,a,f,s,m,h=r[0],l=r[1],p=r[2],y=h.length-1,g=Math.max,d=0;function v(r){var n;if(0===e[r]){for(e[r]=1,n=h[r];n<h[r+1];++n)v(l[n]);i[d]=r,++d}}for("undefined"===typeof t&&(e=numeric.rep([y],0)),"undefined"===typeof t&&(t=numeric.linspace(0,e.length-1)),"undefined"===typeof i&&(i=[]),o=t.length-1;-1!==o;--o)v(t[o]);for(i.length=d,o=i.length-1;-1!==o;--o)e[i[o]]=0;for(o=t.length-1;-1!==o;--o)u=t[o],e[u]=n[u];for(o=i.length-1;-1!==o;--o){for(u=i[o],c=h[u],a=g(h[u+1],c),f=c;f!==a;++f)if(l[f]===u){e[u]/=p[f];break}for(m=e[u],f=c;f!==a;++f)(s=l[f])!==u&&(e[s]-=m*p[f])}return e},numeric.ccsDFS=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS.prototype.dfs=function(r,n,e,t,i,o){var u,c,a,f=0,s=i.length,m=this.k,h=this.k1,l=this.j;if(0===t[r])for(t[r]=1,l[0]=r,m[0]=c=n[r],h[0]=a=n[r+1];;)if(c>=a){if(i[s]=l[f],0===f)return;++s,c=m[--f],a=h[f]}else 0===t[u=o[e[c]]]?(t[u]=1,m[f]=c,l[++f]=u,c=n[u],h[f]=a=n[u+1]):++c},numeric.ccsLPSolve=function(r,n,e,t,i,o,u){var c,a,f,s,m,h,l,p,y,g=r[0],d=r[1],v=r[2],A=(g.length,n[0]),x=n[1],M=n[2];for(a=A[i],f=A[i+1],t.length=0,c=a;c<f;++c)u.dfs(o[x[c]],g,d,e,t,o);for(c=t.length-1;-1!==c;--c)e[t[c]]=0;for(c=a;c!==f;++c)e[s=o[x[c]]]=M[c];for(c=t.length-1;-1!==c;--c){for(m=g[s=t[c]],h=g[s+1],l=m;l<h;++l)if(o[d[l]]===s){e[s]/=v[l];break}for(y=e[s],l=m;l<h;++l)(p=o[d[l]])!==s&&(e[p]-=y*v[l])}return e},numeric.ccsLUP1=function(r,n){var e,t,i,o,u,c,a,f=r[0].length-1,s=[numeric.rep([f+1],0),[],[]],m=[numeric.rep([f+1],0),[],[]],h=s[0],l=s[1],p=s[2],y=m[0],g=m[1],d=m[2],v=numeric.rep([f],0),A=numeric.rep([f],0),x=numeric.ccsLPSolve,M=(Math.max,Math.abs),b=numeric.linspace(0,f-1),T=numeric.linspace(0,f-1),w=new numeric.ccsDFS(f);for("undefined"===typeof n&&(n=1),e=0;e<f;++e){for(x(s,r,v,A,e,T,w),o=-1,u=-1,t=A.length-1;-1!==t;--t)(i=A[t])<=e||(c=M(v[i]))>o&&(u=i,o=c);for(M(v[e])<n*o&&(t=b[e],o=b[u],b[e]=o,T[o]=e,b[u]=t,T[t]=u,o=v[e],v[e]=v[u],v[u]=o),o=h[e],u=y[e],a=v[e],l[o]=b[e],p[o]=1,++o,t=A.length-1;-1!==t;--t)c=v[i=A[t]],A[t]=0,v[i]=0,i<=e?(g[u]=i,d[u]=c,++u):(l[o]=b[i],p[o]=c/a,++o);h[e+1]=o,y[e+1]=u}for(t=l.length-1;-1!==t;--t)l[t]=T[l[t]];return{L:s,U:m,P:b,Pinv:T}},numeric.ccsDFS0=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS0.prototype.dfs=function(r,n,e,t,i,o,u){var c,a,f,s=0,m=i.length,h=this.k,l=this.k1,p=this.j;if(0===t[r])for(t[r]=1,p[0]=r,h[0]=a=n[o[r]],l[0]=f=n[o[r]+1];;){if(isNaN(a))throw new Error("Ow!");if(a>=f){if(i[m]=o[p[s]],0===s)return;++m,a=h[--s],f=l[s]}else 0===t[c=e[a]]?(t[c]=1,h[s]=a,p[++s]=c,a=n[c=o[c]],l[s]=f=n[c+1]):++a}},numeric.ccsLPSolve0=function(r,n,e,t,i,o,u,c){var a,f,s,m,h,l,p,y,g,d=r[0],v=r[1],A=r[2],x=(d.length,n[0]),M=n[1],b=n[2];for(f=x[i],s=x[i+1],t.length=0,a=f;a<s;++a)c.dfs(M[a],d,v,e,t,o,u);for(a=t.length-1;-1!==a;--a)e[u[m=t[a]]]=0;for(a=f;a!==s;++a)e[m=M[a]]=b[a];for(a=t.length-1;-1!==a;--a){for(y=u[m=t[a]],h=d[m],l=d[m+1],p=h;p<l;++p)if(v[p]===y){e[y]/=A[p];break}for(g=e[y],p=h;p<l;++p)e[v[p]]-=g*A[p];e[y]=g}},numeric.ccsLUP0=function(r,n){var e,t,i,o,u,c,a,f=r[0].length-1,s=[numeric.rep([f+1],0),[],[]],m=[numeric.rep([f+1],0),[],[]],h=s[0],l=s[1],p=s[2],y=m[0],g=m[1],d=m[2],v=numeric.rep([f],0),A=numeric.rep([f],0),x=numeric.ccsLPSolve0,M=(Math.max,Math.abs),b=numeric.linspace(0,f-1),T=numeric.linspace(0,f-1),w=new numeric.ccsDFS0(f);for("undefined"===typeof n&&(n=1),e=0;e<f;++e){for(x(s,r,v,A,e,T,b,w),o=-1,u=-1,t=A.length-1;-1!==t;--t)(i=A[t])<=e||(c=M(v[b[i]]))>o&&(u=i,o=c);for(M(v[b[e]])<n*o&&(t=b[e],o=b[u],b[e]=o,T[o]=e,b[u]=t,T[t]=u),o=h[e],u=y[e],a=v[b[e]],l[o]=b[e],p[o]=1,++o,t=A.length-1;-1!==t;--t)c=v[b[i=A[t]]],A[t]=0,v[b[i]]=0,i<=e?(g[u]=i,d[u]=c,++u):(l[o]=b[i],p[o]=c/a,++o);h[e+1]=o,y[e+1]=u}for(t=l.length-1;-1!==t;--t)l[t]=T[l[t]];return{L:s,U:m,P:b,Pinv:T}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(r){return[numeric.sup(r[1])+1,r[0].length-1]},numeric.ccsGetBlock=function(r,n,e){var t=numeric.ccsDim(r),i=t[0],o=t[1];"undefined"===typeof n?n=numeric.linspace(0,i-1):"number"===typeof n&&(n=[n]),"undefined"===typeof e?e=numeric.linspace(0,o-1):"number"===typeof e&&(e=[e]);var u,c,a,f,s=n.length,m=e.length,h=numeric.rep([o],0),l=[],p=[],y=[h,l,p],g=r[0],d=r[1],v=r[2],A=numeric.rep([i],0),x=0,M=numeric.rep([i],0);for(c=0;c<m;++c){var b=g[f=e[c]],T=g[f+1];for(u=b;u<T;++u)M[a=d[u]]=1,A[a]=v[u];for(u=0;u<s;++u)M[n[u]]&&(l[x]=u,p[x]=A[n[u]],++x);for(u=b;u<T;++u)M[a=d[u]]=0;h[c+1]=x}return y},numeric.ccsDot=function(r,n){var e,t,i,o,u,c,a,f,s,m,h,l=r[0],p=r[1],y=r[2],g=n[0],d=n[1],v=n[2],A=numeric.ccsDim(r),x=numeric.ccsDim(n),M=A[0],b=(A[1],x[1]),T=numeric.rep([M],0),w=numeric.rep([M],0),O=Array(M),j=numeric.rep([b],0),k=[],S=[],_=[j,k,S];for(i=0;i!==b;++i){for(o=g[i],u=g[i+1],s=0,t=o;t<u;++t)for(m=d[t],h=v[t],c=l[m],a=l[m+1],e=c;e<a;++e)0===w[f=p[e]]&&(O[s]=f,w[f]=1,s+=1),T[f]=T[f]+y[e]*h;for(u=(o=j[i])+s,j[i+1]=u,t=s-1;-1!==t;--t)h=o+t,e=O[t],k[h]=e,S[h]=T[e],w[e]=0,T[e]=0;j[i+1]=j[i]+s}return _},numeric.ccsLUPSolve=function(r,n){var e=r.L,t=r.U,i=(r.P,n[0]),o=!1;"object"!==typeof i&&(i=(n=[[0,n.length],numeric.linspace(0,n.length-1),n])[0],o=!0);var u,c,a,f,s,m,h=n[1],l=n[2],p=e[0].length-1,y=i.length-1,g=numeric.rep([p],0),d=Array(p),v=numeric.rep([p],0),A=Array(p),x=numeric.rep([y+1],0),M=[],b=[],T=numeric.ccsTSolve,w=0;for(u=0;u<y;++u){for(s=0,a=i[u],f=i[u+1],c=a;c<f;++c)m=r.Pinv[h[c]],A[s]=m,v[m]=l[c],++s;for(A.length=s,T(e,v,g,A,d),c=A.length-1;-1!==c;--c)v[A[c]]=0;if(T(t,g,v,d,A),o)return v;for(c=d.length-1;-1!==c;--c)g[d[c]]=0;for(c=A.length-1;-1!==c;--c)m=A[c],M[w]=m,b[w]=v[m],v[m]=0,++w;x[u+1]=w}return[x,M,b]},numeric.ccsbinop=function(r,n){return"undefined"===typeof n&&(n=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+n+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+r+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(r){var n,e=r[0],t=r[1],i=r[2],o=numeric.sup(t)+1,u=e.length,c=numeric.rep([o],0),a=Array(u),f=Array(u),s=numeric.rep([o],0);for(n=0;n<u;++n)s[t[n]]++;for(n=0;n<o;++n)c[n+1]=c[n]+s[n];var m,h,l=c.slice(0);for(n=0;n<u;++n)a[m=l[h=t[n]]]=e[n],f[m]=i[n],l[h]=l[h]+1;return[c,a,f]},numeric.ccsGather=function(r){var n,e,t,i,o,u=r[0],c=r[1],a=r[2],f=u.length-1,s=c.length,m=Array(s),h=Array(s),l=Array(s);for(o=0,n=0;n<f;++n)for(t=u[n],i=u[n+1],e=t;e!==i;++e)h[o]=n,m[o]=c[e],l[o]=a[e],++o;return[m,h,l]},numeric.sdim=function r(n,e,t){if("undefined"===typeof e&&(e=[]),"object"!==typeof n)return e;var i;for(i in"undefined"===typeof t&&(t=0),t in e||(e[t]=0),n.length>e[t]&&(e[t]=n.length),n)n.hasOwnProperty(i)&&r(n[i],e,t+1);return e},numeric.sclone=function r(n,e,t){"undefined"===typeof e&&(e=0),"undefined"===typeof t&&(t=numeric.sdim(n).length);var i,o=Array(n.length);if(e===t-1){for(i in n)n.hasOwnProperty(i)&&(o[i]=n[i]);return o}for(i in n)n.hasOwnProperty(i)&&(o[i]=r(n[i],e+1,t));return o},numeric.sdiag=function(r){var n,e,t=r.length,i=Array(t);for(n=t-1;n>=1;n-=2)e=n-1,i[n]=[],i[n][n]=r[n],i[e]=[],i[e][e]=r[e];return 0===n&&(i[0]=[],i[0][0]=r[n]),i},numeric.sidentity=function(r){return numeric.sdiag(numeric.rep([r],1))},numeric.stranspose=function(r){var n,e,t,i=[];r.length;for(n in r)if(r.hasOwnProperty(n))for(e in t=r[n])t.hasOwnProperty(e)&&("object"!==typeof i[e]&&(i[e]=[]),i[e][n]=t[e]);return i},numeric.sLUP=function(r,n){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(r,n){var e,t,i,o,u,c,a,f=r.length,s=(n.length,numeric.stranspose(n)),m=s.length,h=Array(f);for(i=f-1;i>=0;i--){for(a=[],e=r[i],u=m-1;u>=0;u--){for(o in c=0,t=s[u],e)e.hasOwnProperty(o)&&o in t&&(c+=e[o]*t[o]);c&&(a[u]=c)}h[i]=a}return h},numeric.sdotMV=function(r,n){var e,t,i,o,u=r.length,c=Array(u);for(t=u-1;t>=0;t--){for(i in o=0,e=r[t])e.hasOwnProperty(i)&&n[i]&&(o+=e[i]*n[i]);o&&(c[t]=o)}return c},numeric.sdotVM=function(r,n){var e,t,i,o,u=[];for(e in r)if(r.hasOwnProperty(e))for(t in i=n[e],o=r[e],i)i.hasOwnProperty(t)&&(u[t]||(u[t]=0),u[t]+=o*i[t]);return u},numeric.sdotVV=function(r,n){var e,t=0;for(e in r)r[e]&&n[e]&&(t+=r[e]*n[e]);return t},numeric.sdot=function(r,n){var e=numeric.sdim(r).length,t=numeric.sdim(n).length;switch(1e3*e+t){case 0:return r*n;case 1001:return numeric.sdotVV(r,n);case 2001:return numeric.sdotMV(r,n);case 1002:return numeric.sdotVM(r,n);case 2002:return numeric.sdotMM(r,n);default:throw new Error("numeric.sdot not implemented for tensors of order "+e+" and "+t)}},numeric.sscatter=function(r){var n,e,t,i,o=r[0].length,u=r.length,c=[];for(e=o-1;e>=0;--e)if(r[u-1][e]){for(i=c,t=0;t<u-2;t++)i[n=r[t][e]]||(i[n]=[]),i=i[n];i[r[t][e]]=r[t+1][e]}return c},numeric.sgather=function r(n,e,t){var i,o,u;for(o in"undefined"===typeof e&&(e=[]),"undefined"===typeof t&&(t=[]),i=t.length,n)if(n.hasOwnProperty(o))if(t[i]=parseInt(o),"number"===typeof(u=n[o])){if(u){if(0===e.length)for(o=i+1;o>=0;--o)e[o]=[];for(o=i;o>=0;--o)e[o].push(t[o]);e[i+1].push(u)}}else r(u,e,t);return t.length>i&&t.pop(),e},numeric.cLU=function(r){var n,e,t,i,o,u,c=r[0],a=r[1],f=r[2],s=c.length,m=0;for(n=0;n<s;n++)c[n]>m&&(m=c[n]);m++;var h,l=Array(m),p=Array(m),y=numeric.rep([m],1/0),g=numeric.rep([m],-1/0);for(t=0;t<s;t++)n=c[t],(e=a[t])<y[n]&&(y[n]=e),e>g[n]&&(g[n]=e);for(n=0;n<m-1;n++)g[n]>g[n+1]&&(g[n+1]=g[n]);for(n=m-1;n>=1;n--)y[n]<y[n-1]&&(y[n-1]=y[n]);for(n=0;n<m;n++)p[n]=numeric.rep([g[n]-y[n]+1],0),l[n]=numeric.rep([n-y[n]],0),n-y[n]+1,g[n]-n+1;for(t=0;t<s;t++)p[n=c[t]][a[t]-y[n]]=f[t];for(n=0;n<m-1;n++)for(i=n-y[n],A=p[n],e=n+1;y[e]<=n&&e<m;e++)if(o=n-y[e],u=g[n]-n,h=(x=p[e])[o]/A[i]){for(t=1;t<=u;t++)x[t+o]-=h*A[t+i];l[e][n-y[e]]=h}var d,v,A=[],x=[],M=[],b=[],T=[],w=[];for(s=0,d=0,n=0;n<m;n++){for(i=y[n],o=g[n],v=p[n],e=n;e<=o;e++)v[e-i]&&(A[s]=n,x[s]=e,M[s]=v[e-i],s++);for(v=l[n],e=i;e<n;e++)v[e-i]&&(b[d]=n,T[d]=e,w[d]=v[e-i],d++);b[d]=n,T[d]=n,w[d]=1,d++}return{U:[A,x,M],L:[b,T,w]}},numeric.cLUsolve=function(r,n){var e,t,i=r.L,o=r.U,u=numeric.clone(n),c=i[0],a=i[1],f=i[2],s=o[0],m=o[1],h=o[2],l=s.length,p=(c.length,u.length);for(t=0,e=0;e<p;e++){for(;a[t]<e;)u[e]-=f[t]*u[a[t]],t++;t++}for(t=l-1,e=p-1;e>=0;e--){for(;m[t]>e;)u[e]-=h[t]*u[m[t]],t--;u[e]/=h[t],t--}return u},numeric.cgrid=function(r,n){"number"===typeof r&&(r=[r,r]);var e,t,i,o=numeric.rep(r,-1);if("function"!==typeof n)switch(n){case"L":n=function(n,e){return n>=r[0]/2||e<r[1]/2};break;default:n=function(r,n){return!0}}for(i=0,e=1;e<r[0]-1;e++)for(t=1;t<r[1]-1;t++)n(e,t)&&(o[e][t]=i,i++);return o},numeric.cdelsq=function(r){var n,e,t,i,o,u=[[-1,0],[0,-1],[0,1],[1,0]],c=numeric.dim(r),a=c[0],f=c[1],s=[],m=[],h=[];for(n=1;n<a-1;n++)for(e=1;e<f-1;e++)if(!(r[n][e]<0)){for(t=0;t<4;t++)i=n+u[t][0],o=e+u[t][1],r[i][o]<0||(s.push(r[n][e]),m.push(r[i][o]),h.push(-1));s.push(r[n][e]),m.push(r[n][e]),h.push(4)}return[s,m,h]},numeric.cdotMV=function(r,n){var e,t,i,o=r[0],u=r[1],c=r[2],a=o.length;for(i=0,t=0;t<a;t++)o[t]>i&&(i=o[t]);for(i++,e=numeric.rep([i],0),t=0;t<a;t++)e[o[t]]+=c[t]*n[u[t]];return e},numeric.Spline=function(r,n,e,t,i){this.x=r,this.yl=n,this.yr=e,this.kl=t,this.kr=i},numeric.Spline.prototype._at=function(r,n){var e,t,i,o=this.x,u=this.yl,c=this.yr,a=this.kl,f=this.kr,s=numeric.add,m=numeric.sub,h=numeric.mul;e=m(h(a[n],o[n+1]-o[n]),m(c[n+1],u[n])),t=s(h(f[n+1],o[n]-o[n+1]),m(c[n+1],u[n]));var l=(i=(r-o[n])/(o[n+1]-o[n]))*(1-i);return s(s(s(h(1-i,u[n]),h(i,c[n+1])),h(e,l*(1-i))),h(t,l*i))},numeric.Spline.prototype.at=function(r){if("number"===typeof r){var n,e,t,i=this.x,o=i.length,u=Math.floor;for(n=0,e=o-1;e-n>1;)i[t=u((n+e)/2)]<=r?n=t:e=t;return this._at(r,n)}o=r.length;var c,a=Array(o);for(c=o-1;-1!==c;--c)a[c]=this.at(r[c]);return a},numeric.Spline.prototype.diff=function(){var r,n,e,t=this.x,i=this.yl,o=this.yr,u=this.kl,c=this.kr,a=i.length,f=u,s=c,m=Array(a),h=Array(a),l=numeric.add,p=numeric.mul,y=numeric.div,g=numeric.sub;for(r=a-1;-1!==r;--r)n=t[r+1]-t[r],e=g(o[r+1],i[r]),m[r]=y(l(p(e,6),p(u[r],-4*n),p(c[r+1],-2*n)),n*n),h[r+1]=y(l(p(e,-6),p(u[r],2*n),p(c[r+1],4*n)),n*n);return new numeric.Spline(t,f,s,m,h)},numeric.Spline.prototype.roots=function(){function r(r){return r*r}var n=[],e=this.x,t=this.yl,i=this.yr,o=this.kl,u=this.kr;"number"===typeof t[0]&&(t=[t],i=[i],o=[o],u=[u]);var c,a,f,s,m,h,l,p,y,g,d,v,A,x,M,b,T,w,O,j,k,S,_,C=t.length,N=e.length-1,P=(n=Array(C),Math.sqrt);for(c=0;c!==C;++c){for(s=t[c],m=i[c],h=o[c],l=u[c],p=[],a=0;a!==N;a++){for(a>0&&m[a]*s[a]<0&&p.push(e[a]),b=e[a+1]-e[a],e[a],d=s[a],v=m[a+1],y=h[a]/b,A=(g=l[a+1]/b)+3*d+2*y-3*v,x=3*(g+y+2*(d-v)),(M=r(y-g+3*(d-v))+12*g*d)<=0?T=(w=A/x)>e[a]&&w<e[a+1]?[e[a],w,e[a+1]]:[e[a],e[a+1]]:(w=(A-P(M))/x,O=(A+P(M))/x,T=[e[a]],w>e[a]&&w<e[a+1]&&T.push(w),O>e[a]&&O<e[a+1]&&T.push(O),T.push(e[a+1])),k=T[0],w=this._at(k,a),f=0;f<T.length-1;f++)if(S=T[f+1],O=this._at(S,a),0!==w)if(0===O||w*O>0)k=S,w=O;else{for(var q=0;!((_=(w*S-O*k)/(w-O))<=k||_>=S);)if((j=this._at(_,a))*O>0)S=_,O=j,-1===q&&(w*=.5),q=-1;else{if(!(j*w>0))break;k=_,w=j,1===q&&(O*=.5),q=1}p.push(_),k=T[f+1],w=this._at(k,a)}else p.push(k),k=S,w=O;0===O&&p.push(S)}n[c]=p}return"number"===typeof this.yl[0]?n[0]:n},numeric.spline=function(r,n,e,t){var i,o=r.length,u=[],c=[],a=[],f=numeric.sub,s=numeric.mul,m=numeric.add;for(i=o-2;i>=0;i--)c[i]=r[i+1]-r[i],a[i]=f(n[i+1],n[i]);"string"!==typeof e&&"string"!==typeof t||(e=t="periodic");var h=[[],[],[]];switch(typeof e){case"undefined":u[0]=s(3/(c[0]*c[0]),a[0]),h[0].push(0,0),h[1].push(0,1),h[2].push(2/c[0],1/c[0]);break;case"string":u[0]=m(s(3/(c[o-2]*c[o-2]),a[o-2]),s(3/(c[0]*c[0]),a[0])),h[0].push(0,0,0),h[1].push(o-2,0,1),h[2].push(1/c[o-2],2/c[o-2]+2/c[0],1/c[0]);break;default:u[0]=e,h[0].push(0),h[1].push(0),h[2].push(1)}for(i=1;i<o-1;i++)u[i]=m(s(3/(c[i-1]*c[i-1]),a[i-1]),s(3/(c[i]*c[i]),a[i])),h[0].push(i,i,i),h[1].push(i-1,i,i+1),h[2].push(1/c[i-1],2/c[i-1]+2/c[i],1/c[i]);switch(typeof t){case"undefined":u[o-1]=s(3/(c[o-2]*c[o-2]),a[o-2]),h[0].push(o-1,o-1),h[1].push(o-2,o-1),h[2].push(1/c[o-2],2/c[o-2]);break;case"string":h[1][h[1].length-1]=0;break;default:u[o-1]=t,h[0].push(o-1),h[1].push(o-1),h[2].push(1)}u="number"!==typeof u[0]?numeric.transpose(u):[u];var l=Array(u.length);if("string"===typeof e)for(i=l.length-1;-1!==i;--i)l[i]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(h)),u[i]),l[i][o-1]=l[i][0];else for(i=l.length-1;-1!==i;--i)l[i]=numeric.cLUsolve(numeric.cLU(h),u[i]);return l="number"===typeof n[0]?l[0]:numeric.transpose(l),new numeric.Spline(r,n,n,l,l)},numeric.fftpow2=function r(n,e){var t=n.length;if(1!==t){var i,o,u=Math.cos,c=Math.sin,a=Array(t/2),f=Array(t/2),s=Array(t/2),m=Array(t/2);for(o=t/2,i=t-1;-1!==i;--i)s[--o]=n[i],m[o]=e[i],--i,a[o]=n[i],f[o]=e[i];r(a,f),r(s,m),o=t/2;var h,l,p,y=-6.283185307179586/t;for(i=t-1;-1!==i;--i)-1===--o&&(o=t/2-1),l=u(h=y*i),p=c(h),n[i]=a[o]+l*s[o]-p*m[o],e[i]=f[o]+l*m[o]+p*s[o]}},numeric._ifftpow2=function r(n,e){var t=n.length;if(1!==t){var i,o,u=Math.cos,c=Math.sin,a=Array(t/2),f=Array(t/2),s=Array(t/2),m=Array(t/2);for(o=t/2,i=t-1;-1!==i;--i)s[--o]=n[i],m[o]=e[i],--i,a[o]=n[i],f[o]=e[i];r(a,f),r(s,m),o=t/2;var h,l,p,y=6.283185307179586/t;for(i=t-1;-1!==i;--i)-1===--o&&(o=t/2-1),l=u(h=y*i),p=c(h),n[i]=a[o]+l*s[o]-p*m[o],e[i]=f[o]+l*m[o]+p*s[o]}},numeric.ifftpow2=function(r,n){numeric._ifftpow2(r,n),numeric.diveq(r,r.length),numeric.diveq(n,n.length)},numeric.convpow2=function(r,n,e,t){var i,o,u,c,a;for(numeric.fftpow2(r,n),numeric.fftpow2(e,t),i=r.length-1;-1!==i;--i)o=r[i],c=n[i],u=e[i],a=t[i],r[i]=o*u-c*a,n[i]=o*a+c*u;numeric.ifftpow2(r,n)},numeric.T.prototype.fft=function(){var r,n,e=this.x,t=this.y,i=e.length,o=Math.log,u=o(2),c=Math.ceil(o(2*i-1)/u),a=Math.pow(2,c),f=numeric.rep([a],0),s=numeric.rep([a],0),m=Math.cos,h=Math.sin,l=-3.141592653589793/i,p=numeric.rep([a],0),y=numeric.rep([a],0);Math.floor(i/2);for(r=0;r<i;r++)p[r]=e[r];if("undefined"!==typeof t)for(r=0;r<i;r++)y[r]=t[r];for(f[0]=1,r=1;r<=a/2;r++)n=l*r*r,f[r]=m(n),s[r]=h(n),f[a-r]=m(n),s[a-r]=h(n);var g=new numeric.T(p,y),d=new numeric.T(f,s);return g=g.mul(d),numeric.convpow2(g.x,g.y,numeric.clone(d.x),numeric.neg(d.y)),(g=g.mul(d)).x.length=i,g.y.length=i,g},numeric.T.prototype.ifft=function(){var r,n,e=this.x,t=this.y,i=e.length,o=Math.log,u=o(2),c=Math.ceil(o(2*i-1)/u),a=Math.pow(2,c),f=numeric.rep([a],0),s=numeric.rep([a],0),m=Math.cos,h=Math.sin,l=3.141592653589793/i,p=numeric.rep([a],0),y=numeric.rep([a],0);Math.floor(i/2);for(r=0;r<i;r++)p[r]=e[r];if("undefined"!==typeof t)for(r=0;r<i;r++)y[r]=t[r];for(f[0]=1,r=1;r<=a/2;r++)n=l*r*r,f[r]=m(n),s[r]=h(n),f[a-r]=m(n),s[a-r]=h(n);var g=new numeric.T(p,y),d=new numeric.T(f,s);return g=g.mul(d),numeric.convpow2(g.x,g.y,numeric.clone(d.x),numeric.neg(d.y)),(g=g.mul(d)).x.length=i,g.y.length=i,g.div(i)},numeric.gradient=function(r,n){var e=n.length,t=r(n);if(isNaN(t))throw new Error("gradient: f(x) is a NaN!");var i,o,u,c,a,f,s,m,h,l=Math.max,p=numeric.clone(n),y=Array(e),g=(numeric.div,numeric.sub,l=Math.max,Math.abs),d=Math.min,v=0;for(i=0;i<e;i++)for(var A=l(1e-6*t,1e-8);;){if(++v>20)throw new Error("Numerical gradient fails");if(p[i]=n[i]+A,o=r(p),p[i]=n[i]-A,u=r(p),p[i]=n[i],isNaN(o)||isNaN(u))A/=16;else{if(y[i]=(o-u)/(2*A),c=n[i]-A,a=n[i],f=n[i]+A,s=(o-t)/A,m=(t-u)/A,h=l(g(y[i]),g(t),g(o),g(u),g(c),g(a),g(f),1e-8),!(d(l(g(s-y[i]),g(m-y[i]),g(s-m))/h,A/h)>.001))break;A/=16}}return y},numeric.uncmin=function(r,n,e,t,i,o,u){var c=numeric.gradient;"undefined"===typeof u&&(u={}),"undefined"===typeof e&&(e=1e-8),"undefined"===typeof t&&(t=function(n){return c(r,n)}),"undefined"===typeof i&&(i=1e3);var a,f,s=(n=numeric.clone(n)).length,m=r(n);if(isNaN(m))throw new Error("uncmin: f(x0) is a NaN!");var h=Math.max,l=numeric.norm2;e=h(e,numeric.epsilon);var p,y,g,d,v,A,x,M,b,T,w=u.Hinv||numeric.identity(s),O=numeric.dot,j=(numeric.inv,numeric.sub),k=numeric.add,S=numeric.tensor,_=numeric.div,C=numeric.mul,N=numeric.all,P=numeric.isFinite,q=numeric.neg,V=0,E="";for(y=t(n);V<i;){if("function"===typeof o&&o(V,n,m,y,w)){E="Callback returned true";break}if(!N(P(y))){E="Gradient has Infinity or NaN";break}if(!N(P(p=q(O(w,y))))){E="Search direction has Infinity or NaN";break}if((T=l(p))<e){E="Newton step smaller than tol";break}for(b=1,f=O(y,p),v=n;V<i&&!(b*T<e)&&(v=k(n,d=C(p,b)),(a=r(v))-m>=.1*b*f||isNaN(a));)b*=.5,++V;if(b*T<e){E="Line search step size smaller than tol";break}if(V===i){E="maxit reached during line search";break}M=O(A=j(g=t(v),y),d),x=O(w,A),w=j(k(w,C((M+O(A,x))/(M*M),S(d,d))),_(k(S(x,d),S(d,x)),M)),n=v,m=a,y=g,++V}return{solution:n,f:m,gradient:y,invHessian:w,iterations:V,message:E}},numeric.Dopri=function(r,n,e,t,i,o,u){this.x=r,this.y=n,this.f=e,this.ymid=t,this.iterations=i,this.events=u,this.message=o},numeric.Dopri.prototype._at=function(r,n){function e(r){return r*r}var t,i,o,u,c,a,f,s,m,h=this,l=h.x,p=h.y,y=h.f,g=h.ymid,d=(l.length,Math.floor,numeric.add),v=numeric.mul,A=numeric.sub;return t=l[n],i=l[n+1],u=p[n],c=p[n+1],o=t+.5*(i-t),a=g[n],f=A(y[n],v(u,1/(t-o)+2/(t-i))),s=A(y[n+1],v(c,1/(i-o)+2/(i-t))),d(d(d(d(v(u,(m=[e(r-i)*(r-o)/e(t-i)/(t-o),e(r-t)*e(r-i)/e(t-o)/e(i-o),e(r-t)*(r-o)/e(i-t)/(i-o),(r-t)*e(r-i)*(r-o)/e(t-i)/(t-o),(r-i)*e(r-t)*(r-o)/e(t-i)/(i-o)])[0]),v(a,m[1])),v(c,m[2])),v(f,m[3])),v(s,m[4]))},numeric.Dopri.prototype.at=function(r){var n,e,t,i=Math.floor;if("number"!==typeof r){var o=r.length,u=Array(o);for(n=o-1;-1!==n;--n)u[n]=this.at(r[n]);return u}var c=this.x;for(n=0,e=c.length-1;e-n>1;)c[t=i(.5*(n+e))]<=r?n=t:e=t;return this._at(r,n)},numeric.dopri=function(r,n,e,t,i,o,u){"undefined"===typeof i&&(i=1e-6),"undefined"===typeof o&&(o=1e3);var c,a,f,s,m,h,l,p,y,g,d,v,A,x=[r],M=[e],b=[t(r,e)],T=[],w=[3/40,9/40],O=[44/45,-56/15,32/9],j=[19372/6561,-25360/2187,64448/6561,-212/729],k=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],S=[35/384,0,500/1113,125/192,-2187/6784,11/84],_=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,5618549.5/235043384],C=[.2,.3,.8,8/9,1,1],N=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40],P=0,q=(n-r)/10,V=0,E=numeric.add,F=numeric.mul,D=(Math.max,Math.min),L=Math.abs,U=numeric.norminf,R=Math.pow,G=numeric.any,I=numeric.lt,B=numeric.and,Q=(numeric.sub,new numeric.Dopri(x,M,b,T,-1,""));for("function"===typeof u&&(d=u(r,e));r<n&&V<o;)if(++V,r+q>n&&(q=n-r),c=t(r+C[0]*q,E(e,F(.2*q,b[P]))),a=t(r+C[1]*q,E(E(e,F(w[0]*q,b[P])),F(w[1]*q,c))),f=t(r+C[2]*q,E(E(E(e,F(O[0]*q,b[P])),F(O[1]*q,c)),F(O[2]*q,a))),s=t(r+C[3]*q,E(E(E(E(e,F(j[0]*q,b[P])),F(j[1]*q,c)),F(j[2]*q,a)),F(j[3]*q,f))),m=t(r+C[4]*q,E(E(E(E(E(e,F(k[0]*q,b[P])),F(k[1]*q,c)),F(k[2]*q,a)),F(k[3]*q,f)),F(k[4]*q,s))),h=t(r+q,y=E(E(E(E(E(e,F(b[P],q*S[0])),F(a,q*S[2])),F(f,q*S[3])),F(s,q*S[4])),F(m,q*S[5]))),(g="number"===typeof(l=E(E(E(E(E(F(b[P],q*N[0]),F(a,q*N[2])),F(f,q*N[3])),F(s,q*N[4])),F(m,q*N[5])),F(h,q*N[6])))?L(l):U(l))>i){if(r+(q=.2*q*R(i/g,.25))===r){Q.msg="Step size became too small";break}}else{if(T[P]=E(E(E(E(E(E(e,F(b[P],q*_[0])),F(a,q*_[2])),F(f,q*_[3])),F(s,q*_[4])),F(m,q*_[5])),F(h,q*_[6])),x[++P]=r+q,M[P]=y,b[P]=h,"function"===typeof u){var X,z,Y=r,Z=r+.5*q;if(v=u(Z,T[P-1]),G(A=B(I(d,0),I(0,v)))||(Y=Z,d=v,v=u(Z=r+q,y),A=B(I(d,0),I(0,v))),G(A)){for(var H,$,J=0,W=1,K=1;;){if("number"===typeof d)z=(K*v*Y-W*d*Z)/(K*v-W*d);else for(z=Z,p=d.length-1;-1!==p;--p)d[p]<0&&v[p]>0&&(z=D(z,(K*v[p]*Y-W*d[p]*Z)/(K*v[p]-W*d[p])));if(z<=Y||z>=Z)break;$=u(z,X=Q._at(z,P-1)),G(H=B(I(d,0),I(0,$)))?(Z=z,v=$,A=H,K=1,-1===J?W*=.5:W=1,J=-1):(Y=z,d=$,W=1,1===J?K*=.5:K=1,J=1)}return y=Q._at(.5*(r+z),P-1),Q.f[P]=t(z,X),Q.x[P]=z,Q.y[P]=X,Q.ymid[P-1]=y,Q.events=A,Q.iterations=V,Q}}r+=q,e=y,d=v,q=D(.8*q*R(i/g,.25),4*q)}return Q.iterations=V,Q},numeric.LU=function(r,n){n=n||!1;var e,t,i,o,u,c,a,f,s,m=Math.abs,h=r.length,l=h-1,p=new Array(h);for(n||(r=numeric.clone(r)),i=0;i<h;++i){for(a=i,s=m((c=r[i])[i]),t=i+1;t<h;++t)s<(o=m(r[t][i]))&&(s=o,a=t);for(p[i]=a,a!=i&&(r[i]=r[a],r[a]=c,c=r[i]),u=c[i],e=i+1;e<h;++e)r[e][i]/=u;for(e=i+1;e<h;++e){for(f=r[e],t=i+1;t<l;++t)f[t]-=f[i]*c[t],f[++t]-=f[i]*c[t];t===l&&(f[t]-=f[i]*c[t])}}return{LU:r,P:p}},numeric.LUsolve=function(r,n){var e,t,i,o,u,c=r.LU,a=c.length,f=numeric.clone(n),s=r.P;for(e=a-1;-1!==e;--e)f[e]=n[e];for(e=0;e<a;++e)for(i=s[e],s[e]!==e&&(u=f[e],f[e]=f[i],f[i]=u),o=c[e],t=0;t<e;++t)f[e]-=f[t]*o[t];for(e=a-1;e>=0;--e){for(o=c[e],t=e+1;t<a;++t)f[e]-=f[t]*o[t];f[e]/=o[e]}return f},numeric.solve=function(r,n,e){return numeric.LUsolve(numeric.LU(r,e),n)},numeric.echelonize=function(r){var n,e,t,i,o,u,c,a,f=numeric.dim(r),s=f[0],m=f[1],h=numeric.identity(s),l=Array(s),p=Math.abs,y=numeric.diveq;for(r=numeric.clone(r),n=0;n<s;++n){for(t=0,o=r[n],u=h[n],e=1;e<m;++e)p(o[t])<p(o[e])&&(t=e);for(l[n]=t,y(u,o[t]),y(o,o[t]),e=0;e<s;++e)if(e!==n){for(a=(c=r[e])[t],i=m-1;-1!==i;--i)c[i]-=o[i]*a;for(c=h[e],i=s-1;-1!==i;--i)c[i]-=u[i]*a}}return{I:h,A:r,P:l}},numeric.__solveLP=function(r,n,e,t,i,o,u){var c,a,f,s,m=numeric.sum,h=(numeric.log,numeric.mul),l=numeric.sub,p=numeric.dot,y=numeric.div,g=numeric.add,d=r.length,v=e.length,A=!1,x=1,M=(numeric.transpose(n),numeric.svd,numeric.transpose),b=(numeric.leq,Math.sqrt),T=Math.abs,w=(numeric.muleq,numeric.norminf,numeric.any,Math.min),O=numeric.all,j=numeric.gt,k=Array(d),S=Array(v),_=(numeric.rep([v],1),numeric.solve),C=l(e,p(n,o)),N=p(r,r);for(f=0;f<i;++f){var P,q;for(P=v-1;-1!==P;--P)S[P]=y(n[P],C[P]);var V=M(S);for(P=d-1;-1!==P;--P)k[P]=m(V[P]);x=.25*T(N/p(r,k));var E=100*b(N/p(k,k));for((!isFinite(x)||x>E)&&(x=E),s=g(r,h(x,k)),a=p(V,S),P=d-1;-1!==P;--P)a[P][P]+=1;q=_(a,y(s,x),!0);var F=y(C,p(n,q)),D=1;for(P=v-1;-1!==P;--P)F[P]<0&&(D=w(D,-.999*F[P]));if(c=l(o,h(q,D)),!O(j(C=l(e,p(n,c)),0)))return{solution:o,message:"",iterations:f};if(o=c,x<t)return{solution:c,message:"",iterations:f};if(u){var L=p(r,s),U=p(n,s);for(A=!0,P=v-1;-1!==P;--P)if(L*U[P]<0){A=!1;break}}else A=!(o[d-1]>=0);if(A)return{solution:c,message:"Unbounded",iterations:f}}return{solution:o,message:"maximum iteration count exceeded",iterations:f}},numeric._solveLP=function(r,n,e,t,i){var o=r.length,u=e.length,c=(numeric.sum,numeric.log,numeric.mul,numeric.sub),a=numeric.dot,f=(numeric.div,numeric.add,numeric.rep([o],0).concat([1])),s=numeric.rep([u,1],-1),m=numeric.blockMatrix([[n,s]]),h=e,l=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(e)))+1),p=numeric.__solveLP(f,m,h,t,i,l,!1),y=numeric.clone(p.solution);if(y.length=o,numeric.inf(c(e,a(n,y)))<0)return{solution:NaN,message:"Infeasible",iterations:p.iterations};var g=numeric.__solveLP(r,n,e,t,i-p.iterations,y,!0);return g.iterations+=p.iterations,g},numeric.solveLP=function(r,n,e,t,i,o,u){if("undefined"===typeof u&&(u=1e3),"undefined"===typeof o&&(o=numeric.epsilon),"undefined"===typeof t)return numeric._solveLP(r,n,e,o,u);var c,a=t.length,f=t[0].length,s=n.length,m=numeric.echelonize(t),h=numeric.rep([f],0),l=m.P,p=[];for(c=l.length-1;-1!==c;--c)h[l[c]]=1;for(c=f-1;-1!==c;--c)0===h[c]&&p.push(c);var y=numeric.getRange,g=numeric.linspace(0,a-1),d=numeric.linspace(0,s-1),v=y(t,g,p),A=y(n,d,l),x=y(n,d,p),M=numeric.dot,b=numeric.sub,T=M(A,m.I),w=b(x,M(T,v)),O=b(e,M(T,i)),j=Array(l.length),k=Array(p.length);for(c=l.length-1;-1!==c;--c)j[c]=r[l[c]];for(c=p.length-1;-1!==c;--c)k[c]=r[p[c]];var S=b(k,M(j,M(m.I,v))),_=numeric._solveLP(S,w,O,o,u),C=_.solution;if(C!==C)return _;var N=M(m.I,b(i,M(v,C))),P=Array(r.length);for(c=l.length-1;-1!==c;--c)P[l[c]]=N[c];for(c=p.length-1;-1!==c;--c)P[p[c]]=C[c];return{solution:P,message:_.message,iterations:_.iterations}},numeric.MPStoLP=function(r){r instanceof String&&r.split("\n");var n,e,t,i,o=0,u=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],c=r.length,a=0,f={},s=[],m=0,h={},l=0,p=[],y=[],g=[];function d(e){throw new Error("MPStoLP: "+e+"\nLine "+n+": "+r[n]+"\nCurrent state: "+u[o]+"\n")}for(n=0;n<c;++n){var v=(t=r[n]).match(/\S*/g),A=[];for(e=0;e<v.length;++e)""!==v[e]&&A.push(v[e]);if(0!==A.length){for(e=0;e<u.length&&t.substr(0,u[e].length)!==u[e];++e);if(e<u.length){if(o=e,1===e&&(i=A[1]),6===e)return{name:i,c:p,A:numeric.transpose(y),b:g,rows:f,vars:h}}else switch(o){case 0:case 1:d("Unexpected line");case 2:switch(A[0]){case"N":0===a?a=A[1]:d("Two or more N rows");break;case"L":f[A[1]]=m,s[m]=1,g[m]=0,++m;break;case"G":f[A[1]]=m,s[m]=-1,g[m]=0,++m;break;case"E":f[A[1]]=m,s[m]=0,g[m]=0,++m;break;default:d("Parse error "+numeric.prettyPrint(A))}break;case 3:h.hasOwnProperty(A[0])||(h[A[0]]=l,p[l]=0,y[l]=numeric.rep([m],0),++l);var x=h[A[0]];for(e=1;e<A.length;e+=2)if(A[e]!==a){var M=f[A[e]];y[x][M]=(s[M]<0?-1:1)*parseFloat(A[e+1])}else p[x]=parseFloat(A[e+1]);break;case 4:for(e=1;e<A.length;e+=2)g[f[A[e]]]=(s[f[A[e]]]<0?-1:1)*parseFloat(A[e+1]);break;case 5:break;case 6:d("Internal error")}}}d("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(r,n,e,t,i,o,u){function c(r){var n,t,i=this,o=r.length,u=0,c=i.i=i.j=i.m=0;for(i.S=[],i.c=[],o||(r=[o++]);u<e;)i.S[u]=u++;for(u=0;u<e;u++)c=s(c+(n=i.S[u])+r[u%o]),t=i.S[c],i.S[u]=t,i.S[c]=n;i.g=function(r){var n=i.S,t=s(i.i+1),o=n[t],u=s(i.j+o),c=n[u];n[t]=c,n[u]=o;for(var a=n[s(o+c)];--r;)t=s(t+1),c=n[u=s(u+(o=n[t]))],n[t]=c,n[u]=o,a=a*e+n[s(o+c)];return i.i=t,i.j=u,a},i.g(e)}function a(r,n,e,t,i){if(e=[],i=typeof r,n&&"object"==i)for(t in r)if(t.indexOf("S")<5)try{e.push(a(r[t],n-1))}catch(o){}return e.length?e:r+("string"!=i?"\0":"")}function f(r,n,e,t){for(r+="",e=0,t=0;t<r.length;t++)n[s(t)]=s((e^=19*n[s(t)])+r.charCodeAt(t));for(t in r="",n)r+=String.fromCharCode(n[t]);return r}function s(r){return 255&r}n.seedrandom=function(t,s){var m,h=[];return t=f(a(s?[t,r]:arguments.length?t:[(new Date).getTime(),r,window],3),h),f((m=new c(h)).S,r),n.random=function(){for(var r=m.g(6),n=u,t=0;r<i;)r=(r+t)*e,n*=e,t=m.g(1);for(;r>=o;)r/=2,n/=2,t>>>=1;return(r+t)/n},t},u=n.pow(e,6),i=n.pow(2,i),o=2*i,f(n.random(),r)}([],numeric.seedrandom,256,0,52),function(r){function n(r){if("object"!==typeof r)return r;var e,t=[],i=r.length;for(e=0;e<i;e++)t[e+1]=n(r[e]);return t}function e(r){if("object"!==typeof r)return r;var n,t=[],i=r.length;for(n=1;n<i;n++)t[n-1]=e(r[n]);return t}function t(r,n,e,t,i,o,u,c,a,f,s,m,h,l,p,y){var g,d,v,A,x,M,b,T,w,O,j,k,S,_,C,N,P,q,V,E,F,D,L,U,R,G,I;S=Math.min(t,f),v=2*t+S*(S+5)/2+2*f+1,U=1e-60;do{R=1+.1*(U+=U),G=1+.2*U}while(R<=1||G<=1);for(g=1;g<=t;g+=1)p[g]=n[g];for(g=t+1;g<=v;g+=1)p[g]=0;for(g=1;g<=f;g+=1)m[g]=0;if(x=[],0===y[1]){if(function(r,n,e,t){var i,o,u,c,a,f;for(o=1;o<=e;o+=1){if(t[1]=o,f=0,(u=o-1)<1){if((f=r[o][o]-f)<=0)break;r[o][o]=Math.sqrt(f)}else{for(c=1;c<=u;c+=1){for(a=r[c][o],i=1;i<c;i+=1)a-=r[i][o]*r[i][c];a/=r[c][c],r[c][o]=a,f+=a*a}if((f=r[o][o]-f)<=0)break;r[o][o]=Math.sqrt(f)}t[1]=0}}(r,0,t,x),0!==x[1])return void(y[1]=2);!function(r,n,e,t){var i,o,u,c;for(o=1;o<=e;o+=1){for(c=0,i=1;i<o;i+=1)c+=r[i][o]*t[i];t[o]=(t[o]-c)/r[o][o]}for(u=1;u<=e;u+=1)for(t[o=e+1-u]=t[o]/r[o][o],c=-t[o],i=1;i<o;i+=1)t[i]=t[i]+c*r[i][o]}(r,0,t,n),function(r,n,e){var t,i,o,u,c;for(o=1;o<=e;o+=1){for(r[o][o]=1/r[o][o],c=-r[o][o],t=1;t<o;t+=1)r[t][o]=c*r[t][o];if(e<(u=o+1))break;for(i=u;i<=e;i+=1)for(c=r[o][i],r[o][i]=0,t=1;t<=o;t+=1)r[t][i]=r[t][i]+c*r[t][o]}}(r,0,t)}else{for(d=1;d<=t;d+=1)for(i[d]=0,g=1;g<=d;g+=1)i[d]=i[d]+r[g][d]*n[g];for(d=1;d<=t;d+=1)for(n[d]=0,g=d;g<=t;g+=1)n[d]=n[d]+r[d][g]*i[g]}for(o[1]=0,d=1;d<=t;d+=1)for(i[d]=n[d],o[1]=o[1]+p[d]*i[d],p[d]=0,g=d+1;g<=t;g+=1)r[g][d]=0;for(o[1]=-o[1]/2,y[1]=0,_=(O=(w=(j=(T=(b=t)+t)+S)+S+1)+S*(S+1)/2)+f,g=1;g<=f;g+=1){for(N=0,d=1;d<=t;d+=1)N+=u[d][g]*u[d][g];p[_+g]=Math.sqrt(N)}function B(){for(l[1]=l[1]+1,v=O,g=1;g<=f;g+=1){for(v+=1,N=-c[g],d=1;d<=t;d+=1)N+=u[d][g]*i[d];if(Math.abs(N)<U&&(N=0),g>s)p[v]=N;else if(p[v]=-Math.abs(N),N>0){for(d=1;d<=t;d+=1)u[d][g]=-u[d][g];c[g]=-c[g]}}for(g=1;g<=h;g+=1)p[O+m[g]]=0;for(k=0,C=0,g=1;g<=f;g+=1)p[O+g]<C*p[_+g]&&(k=g,C=p[O+g]/p[_+g]);return 0===k?999:0}function Q(){for(g=1;g<=t;g+=1){for(N=0,d=1;d<=t;d+=1)N+=r[d][g]*u[d][k];p[g]=N}for(A=b,g=1;g<=t;g+=1)p[A+g]=0;for(d=h+1;d<=t;d+=1)for(g=1;g<=t;g+=1)p[A+g]=p[A+g]+r[g][d]*p[d];for(D=!0,g=h;g>=1;g-=1){for(N=p[g],A=(v=w+g*(g+3)/2)-g,d=g+1;d<=h;d+=1)N-=p[v]*p[T+d],v+=d;if(N/=p[A],p[T+g]=N,m[g]<s)break;if(N<0)break;D=!1,M=g}if(!D)for(P=p[j+M]/p[T+M],g=1;g<=h&&!(m[g]<s)&&!(p[T+g]<0);g+=1)(C=p[j+g]/p[T+g])<P&&(P=C,M=g);for(N=0,g=b+1;g<=b+t;g+=1)N+=p[g]*p[g];if(Math.abs(N)<=U){if(D)return y[1]=1,999;for(g=1;g<=h;g+=1)p[j+g]=p[j+g]-P*p[T+g];return p[j+h+1]=p[j+h+1]+P,700}for(N=0,g=1;g<=t;g+=1)N+=p[b+g]*u[g][k];for(q=-p[O+k]/N,L=!0,D||P<q&&(q=P,L=!1),g=1;g<=t;g+=1)i[g]=i[g]+q*p[b+g],Math.abs(i[g])<U&&(i[g]=0);for(o[1]=o[1]+q*N*(q/2+p[j+h+1]),g=1;g<=h;g+=1)p[j+g]=p[j+g]-q*p[T+g];if(p[j+h+1]=p[j+h+1]+q,!L){for(N=-c[k],d=1;d<=t;d+=1)N+=i[d]*u[d][k];if(k>s)p[O+k]=N;else if(p[O+k]=-Math.abs(N),N>0){for(d=1;d<=t;d+=1)u[d][k]=-u[d][k];c[k]=-c[k]}return 700}for(m[h+=1]=k,v=w+(h-1)*h/2+1,g=1;g<=h-1;g+=1)p[v]=p[g],v+=1;if(h===t)p[v]=p[t];else{for(g=t;g>=h+1&&0!==p[g]&&(V=Math.max(Math.abs(p[g-1]),Math.abs(p[g])),E=Math.min(Math.abs(p[g-1]),Math.abs(p[g])),C=p[g-1]>=0?Math.abs(V*Math.sqrt(1+E*E/(V*V))):-Math.abs(V*Math.sqrt(1+E*E/(V*V))),V=p[g-1]/C,E=p[g]/C,1!==V);g-=1)if(0===V)for(p[g-1]=E*C,d=1;d<=t;d+=1)C=r[d][g-1],r[d][g-1]=r[d][g],r[d][g]=C;else for(p[g-1]=C,F=E/(1+V),d=1;d<=t;d+=1)C=V*r[d][g-1]+E*r[d][g],r[d][g]=F*(r[d][g-1]+C)-r[d][g],r[d][g-1]=C;p[v]=p[h]}return 0}function X(){if(0===p[A=(v=w+M*(M+1)/2+1)+M])return 798;if(V=Math.max(Math.abs(p[A-1]),Math.abs(p[A])),E=Math.min(Math.abs(p[A-1]),Math.abs(p[A])),C=p[A-1]>=0?Math.abs(V*Math.sqrt(1+E*E/(V*V))):-Math.abs(V*Math.sqrt(1+E*E/(V*V))),V=p[A-1]/C,E=p[A]/C,1===V)return 798;if(0===V){for(g=M+1;g<=h;g+=1)C=p[A-1],p[A-1]=p[A],p[A]=C,A+=g;for(g=1;g<=t;g+=1)C=r[g][M],r[g][M]=r[g][M+1],r[g][M+1]=C}else{for(F=E/(1+V),g=M+1;g<=h;g+=1)C=V*p[A-1]+E*p[A],p[A]=F*(p[A-1]+C)-p[A],p[A-1]=C,A+=g;for(g=1;g<=t;g+=1)C=V*r[g][M]+E*r[g][M+1],r[g][M+1]=F*(r[g][M]+C)-r[g][M+1],r[g][M]=C}return 0}function z(){for(A=v-M,g=1;g<=M;g+=1)p[A]=p[v],v+=1,A+=1;return p[j+M]=p[j+M+1],m[M]=m[M+1],(M+=1)<h?797:0}function Y(){return p[j+h]=p[j+h+1],p[j+h+1]=0,m[h]=0,h-=1,l[2]=l[2]+1,0}for(h=0,l[1]=0,l[2]=0,I=0;;){if(999===(I=B()))return;for(;0!==(I=Q());){if(999===I)return;if(700===I)if(M===h)Y();else{for(;X(),797===(I=z()););Y()}}}}r.solveQP=function(r,i,o,u,c,a){r=n(r),i=n(i),o=n(o);var f,s,m,h,l,p=[],y=[],g=[],d=[],v=[];if(c=c||0,a=a?n(a):[void 0,0],u=u?n(u):[],s=r.length-1,m=o[1].length-1,!u)for(f=1;f<=m;f+=1)u[f]=0;for(f=1;f<=m;f+=1)y[f]=0;for(0,h=Math.min(s,m),f=1;f<=s;f+=1)g[f]=0;for(p[1]=0,f=1;f<=2*s+h*(h+5)/2+2*m+1;f+=1)d[f]=0;for(f=1;f<=2;f+=1)v[f]=0;return t(r,i,0,s,g,p,o,u,0,m,c,y,0,v,d,a),l="",1===a[1]&&(l="constraints are inconsistent, no solution!"),2===a[1]&&(l="matrix D in quadratic function is not positive definite!"),{solution:e(g),value:e(p),unconstrained_solution:e(i),iterations:e(v),iact:e(y),message:l}}}(numeric),numeric.svd=function(r){var n,e=numeric.epsilon,t=1e-64/e,i=0,o=0,u=0,c=0,a=0,f=numeric.clone(r),s=f.length,m=f[0].length;if(s<m)throw"Need more rows than columns";var h=new Array(m),l=new Array(m);for(o=0;o<m;o++)h[o]=l[o]=0;var p=numeric.rep([m,m],0);function y(r,n){return(r=Math.abs(r))>(n=Math.abs(n))?r*Math.sqrt(1+n*n/r/r):0==n?r:n*Math.sqrt(1+r*r/n/n)}var g=0,d=0,v=0,A=0,x=0,M=0,b=0;for(o=0;o<m;o++){for(h[o]=d,b=0,a=o+1,u=o;u<s;u++)b+=f[u][o]*f[u][o];if(b<=t)d=0;else for(g=f[o][o],d=Math.sqrt(b),g>=0&&(d=-d),v=g*d-b,f[o][o]=g-d,u=a;u<m;u++){for(b=0,c=o;c<s;c++)b+=f[c][o]*f[c][u];for(g=b/v,c=o;c<s;c++)f[c][u]+=g*f[c][o]}for(l[o]=d,b=0,u=a;u<m;u++)b+=f[o][u]*f[o][u];if(b<=t)d=0;else{for(g=f[o][o+1],d=Math.sqrt(b),g>=0&&(d=-d),v=g*d-b,f[o][o+1]=g-d,u=a;u<m;u++)h[u]=f[o][u]/v;for(u=a;u<s;u++){for(b=0,c=a;c<m;c++)b+=f[u][c]*f[o][c];for(c=a;c<m;c++)f[u][c]+=b*h[c]}}(x=Math.abs(l[o])+Math.abs(h[o]))>A&&(A=x)}for(o=m-1;-1!=o;o+=-1){if(0!=d){for(v=d*f[o][o+1],u=a;u<m;u++)p[u][o]=f[o][u]/v;for(u=a;u<m;u++){for(b=0,c=a;c<m;c++)b+=f[o][c]*p[c][u];for(c=a;c<m;c++)p[c][u]+=b*p[c][o]}}for(u=a;u<m;u++)p[o][u]=0,p[u][o]=0;p[o][o]=1,d=h[o],a=o}for(o=m-1;-1!=o;o+=-1){for(a=o+1,d=l[o],u=a;u<m;u++)f[o][u]=0;if(0!=d){for(v=f[o][o]*d,u=a;u<m;u++){for(b=0,c=a;c<s;c++)b+=f[c][o]*f[c][u];for(g=b/v,c=o;c<s;c++)f[c][u]+=g*f[c][o]}for(u=o;u<s;u++)f[u][o]=f[u][o]/d}else for(u=o;u<s;u++)f[u][o]=0;f[o][o]+=1}for(e*=A,c=m-1;-1!=c;c+=-1)for(var T=0;T<50;T++){var w=!1;for(a=c;-1!=a;a+=-1){if(Math.abs(h[a])<=e){w=!0;break}if(Math.abs(l[a-1])<=e)break}if(!w){i=0,b=1;var O=a-1;for(o=a;o<c+1&&(g=b*h[o],h[o]=i*h[o],!(Math.abs(g)<=e));o++)for(v=y(g,d=l[o]),l[o]=v,i=d/v,b=-g/v,u=0;u<s;u++)x=f[u][O],M=f[u][o],f[u][O]=x*i+M*b,f[u][o]=-x*b+M*i}if(M=l[c],a==c){if(M<0)for(l[c]=-M,u=0;u<m;u++)p[u][c]=-p[u][c];break}if(T>=49)throw"Error: no convergence.";for(A=l[a],d=y(g=(((x=l[c-1])-M)*(x+M)+((d=h[c-1])-(v=h[c]))*(d+v))/(2*v*x),1),g=g<0?((A-M)*(A+M)+v*(x/(g-d)-v))/A:((A-M)*(A+M)+v*(x/(g+d)-v))/A,i=1,b=1,o=a+1;o<c+1;o++){for(d=h[o],x=l[o],v=b*d,d*=i,M=y(g,v),h[o-1]=M,g=A*(i=g/M)+d*(b=v/M),d=-A*b+d*i,v=x*b,x*=i,u=0;u<m;u++)A=p[u][o-1],M=p[u][o],p[u][o-1]=A*i+M*b,p[u][o]=-A*b+M*i;for(M=y(g,v),l[o-1]=M,g=(i=g/M)*d+(b=v/M)*x,A=-b*d+i*x,u=0;u<s;u++)x=f[u][o-1],M=f[u][o],f[u][o-1]=x*i+M*b,f[u][o]=-x*b+M*i}h[a]=0,h[c]=g,l[c]=A}for(o=0;o<l.length;o++)l[o]<e&&(l[o]=0);for(o=0;o<m;o++)for(u=o-1;u>=0;u--)if(l[u]<l[o]){for(i=l[u],l[u]=l[o],l[o]=i,c=0;c<f.length;c++)n=f[c][o],f[c][o]=f[c][u],f[c][u]=n;for(c=0;c<p.length;c++)n=p[c][o],p[c][o]=p[c][u],p[c][u]=n;o=u}return{U:f,S:l,V:p}}}).call(this,__webpack_require__(1))},function(r,n){var e;e=function(){return this}();try{e=e||new Function("return this")()}catch(t){"object"===typeof window&&(e=window)}r.exports=e},function(r,n,e){"use strict";e.r(n);var t=e(0),i=e.n(t);function o(r,n,e){return n in r?Object.defineProperty(r,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[n]=e,r}function u(r,n){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(r);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable}))),e.push.apply(e,t)}return e}function c(r){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?u(Object(e),!0).forEach((function(n){o(r,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):u(Object(e)).forEach((function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(e,n))}))}return r}function a(r,n){(null==n||n>r.length)&&(n=r.length);for(var e=0,t=new Array(n);e<n;e++)t[e]=r[e];return t}function f(r){return function(r){if(Array.isArray(r))return a(r)}(r)||function(r){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(r))return Array.from(r)}(r)||function(r,n){if(r){if("string"===typeof r)return a(r,n);var e=Object.prototype.toString.call(r).slice(8,-1);return"Object"===e&&r.constructor&&(e=r.constructor.name),"Map"===e||"Set"===e?Array.from(r):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?a(r,n):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var s=i.a.identity(4),m=i.a.identity(4),h=[],l=[],p=[],y=[],g=["SEQRES   1 A    1  A\nATOM      1  C1'   A A   1      -2.479   5.346   0.000\nATOM      2  N9    A A   1      -1.291   4.498   0.000\nATOM      3  C8    A A   1       0.024   4.897   0.000\nATOM      4  N7    A A   1       0.877   3.902   0.000\nATOM      5  C5    A A   1       0.071   2.771   0.000\nATOM      6  C6    A A   1       0.369   1.398   0.000\nATOM      7  N6    A A   1       1.611   0.909   0.000\nATOM      8  N1    A A   1      -0.668   0.532   0.000\nATOM      9  C2    A A   1      -1.912   1.023   0.000\nATOM     10  N3    A A   1      -2.320   2.290   0.000\nATOM     11  C4    A A   1      -1.267   3.124   0.000\nEND","SEQRES   1 A    1  G\nATOM      1  C1'   G A   1      -2.477   5.399   0.000\nATOM      2  N9    G A   1      -1.289   4.551   0.000\nATOM      3  C8    G A   1       0.023   4.962   0.000\nATOM      4  N7    G A   1       0.870   3.969   0.000\nATOM      5  C5    G A   1       0.071   2.833   0.000\nATOM      6  C6    G A   1       0.424   1.460   0.000\nATOM      7  O6    G A   1       1.554   0.955   0.000\nATOM      8  N1    G A   1      -0.700   0.641   0.000\nATOM      9  C2    G A   1      -1.999   1.087   0.000\nATOM     10  N2    G A   1      -2.949   0.139  -0.001\nATOM     11  N3    G A   1      -2.342   2.364   0.001\nATOM     12  C4    G A   1      -1.265   3.177   0.000\nEND","SEQRES   1 A    1  T\nATOM      1  C1'   T A   1      -2.481   5.354   0.000\nATOM      2  N1    T A   1      -1.284   4.500   0.000\nATOM      3  C2    T A   1      -1.462   3.135   0.000\nATOM      4  O2    T A   1      -2.562   2.608   0.000\nATOM      5  N3    T A   1      -0.298   2.407   0.000\nATOM      6  C4    T A   1       0.994   2.897   0.000\nATOM      7  O4    T A   1       1.944   2.119   0.000\nATOM      8  C5    T A   1       1.106   4.338   0.000\nATOM      9  C7    T A   1       2.466   4.961   0.001\nATOM     10  C6    T A   1      -0.024   5.057   0.000\nEND","SEQRES   1 A    1  C\nATOM      1  C1'   C A   1      -2.477   5.402   0.000\nATOM      2  N1    C A   1      -1.287   4.523   0.000\nATOM      3  C2    C A   1      -1.477   3.143   0.000\nATOM      4  O2    C A   1      -2.623   2.684   0.001\nATOM      5  N3    C A   1      -0.385   2.335   0.000\nATOM      6  C4    C A   1       0.849   2.855   0.000\nATOM      7  N4    C A   1       1.883   2.020   0.001\nATOM      8  C5    C A   1       1.065   4.271   0.000\nATOM      9  C6    C A   1      -0.038   5.062   0.000\nEND","SEQRES   1 A    1  A\nATOM      1  O3'   A A   1       0.000  -0.929  -1.315\nATOM      2  P     A A   1       0.000   0.000   0.000\nATOM      3  OP1   A A   1      -1.208   0.854  -0.000\nATOM      4  OP2   A A   1       1.208   0.854   0.000\nATOM      5  O5'   A A   1       0.000  -0.930   1.315\nEND"],d=0,v=0;function A(){var r,n,e,t;if(0===d){do{t=(r=2*Math.random()-1)*r+(n=2*Math.random()-1)*n}while(t>=1||0===t);return e=Math.sqrt(-2*Math.log(t)/t),v=r*e,d=1,n*e}return d=0,v}function x(){var r=0,n={};return["A","G","T","C","pho"].forEach((function(e){for(var t=g[r].split("\n"),i=[],o=1;o<t.length-1;o++){var u={};u.name=t[o].charAt(13)+(" "!==t[o].charAt(14)?t[o].charAt(14):"")+(" "!==t[o].charAt(15)?t[o].charAt(15):""),u.x=parseFloat(t[o].substring(30,38)),u.y=parseFloat(t[o].substring(38,46)),u.z=parseFloat(t[o].substring(46,54)),i.push(u)}r++,n[e]=i})),n}function M(r){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],e=5,t=[[r[0],r[1],r[2]]],o=[[r[3],r[4],r[5]]];t=i.a.mul(t,.5/e);var u=i.a.identity(3);u[0][0]=0,u[1][1]=0,u[2][2]=0,u[0][1]=-t[0][2],u[0][2]=t[0][1],u[1][2]=-t[0][0],u=i.a.sub(u,i.a.transpose(u));var c=i.a.dot(t,i.a.transpose(t))[0][0],a=i.a.add(u,i.a.dot(u,u));a=i.a.mul(a,2/(1+c));for(var f=i.a.add(i.a.identity(3),a),s=i.a.identity(4),h=0;h<3;h++)for(var l=0;l<3;l++)s[h][l]=f[h][l];var p=i.a.mul(t,e*(2/(1+Math.sqrt(1+i.a.dot(t,i.a.transpose(t))[0][0]))));if(t=i.a.mul(p,.5/e),(u=i.a.identity(3))[0][0]=0,u[1][1]=0,u[2][2]=0,u[0][1]=-t[0][2],u[0][2]=t[0][1],u[1][2]=-t[0][0],u=i.a.sub(u,i.a.transpose(u)),c=i.a.dot(t,i.a.transpose(t))[0][0],a=i.a.add(u,i.a.dot(u,u)),m=i.a.add(i.a.identity(3),i.a.mul(a,2/(1+c))),n)return s[0][3]=o[0][0],s[1][3]=o[0][1],s[2][3]=o[0][2],s;var y=i.a.dot(m,i.a.transpose(o));return s[0][3]=y[0][0],s[1][3]=y[1][0],s[2][3]=y[2][0],s}function b(r){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],e="";return"C"===r.charAt(1)&&(e="G"),"T"!==r.charAt(1)&&"U"!==r.charAt(1)||(e="A"),"G"===r.charAt(1)&&(e="C"),"A"===r.charAt(1)&&(e=void 0===n||!1===n?"T":"U"),"C"===r.charAt(0)&&(e+="G"),"T"!==r.charAt(0)&&"U"!==r.charAt(0)||(e+="A"),"G"===r.charAt(0)&&(e+="C"),"A"===r.charAt(0)&&(e+=void 0===n||!1===n?"T":"U"),e}function T(r){var n=[];n.length=r.length;for(var e=0;e<r.length;e++){n[e]=[],n[e].length=r[e].length;for(var t=0;t<r[e].length;t++)n[e][t]=r[e][t]}return n}function w(r,n){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=i.a.identity(4);null!==t&&(o=t),e&&(p=[]);var u=M(r.slice(0,6));u[0][3]=-r[3]/2,u[1][3]=-r[4]/2,u[2][3]=-r[5]/2,m=i.a.transpose(m);for(var a=0;a<3;a++)for(var g=0;g<3;g++)u[a][g]=m[a][g];var d=i.a.dot(o,u),v=i.a.dot(d,M(r.slice(0,6)));d[0][1]*=-1,d[1][1]*=-1,d[2][1]*=-1,d[0][2]*=-1,d[1][2]*=-1,d[2][2]*=-1,e&&(p.push(v),p.push(d));var A=i.a.dot(d,M(r.slice(6,12),!0));if(e&&p.push(A),e){s=i.a.add(M(r.slice(12,18)),i.a.identity(4));for(var w=0;w<3;w++)for(var O=0;O<3;O++)s[w][O]=m[w][O];s[0][3]=s[0][3]/2,s[1][3]=s[1][3]/2,s[2][3]=s[2][3]/2,p.push(i.a.dot(o,M(r.slice(12,18))))}o=i.a.dot(o,M(r.slice(12,18))),y=T(o),(u=M(r.slice(24,30)))[0][3]=-r[27]/2,u[1][3]=-r[28]/2,u[2][3]=-r[29]/2,m=i.a.transpose(m);for(var j=0;j<3;j++)for(var k=0;k<3;k++)u[j][k]=m[j][k];var S=i.a.dot(o,u),_=i.a.dot(S,M(r.slice(24,30)));S[0][1]*=-1,S[1][1]*=-1,S[2][1]*=-1,S[0][2]*=-1,S[1][2]*=-1,S[2][2]*=-1,e&&(p.push(_),p.push(S));var C=i.a.dot(_,M(r.slice(18,24),!0));e&&p.push(C);var N=n[1],P=n[2],q=b(n[1],!1),V=b(n[2],!1),E=[],F=[],D=[],L=[],U=[],R=[],G=x();E=f(G[N]),F=f(G[P]),D=f(G[q]),L=f(G[V]),U=f(G.pho),R=f(G.pho);var I=1,B=[],Q=[],X=[N,"pho",P,V,"pho",q];return[E,U,F,L,R,D].forEach((function(r){var n=[];1===I&&(n=v),2===I&&(n=C),3===I&&(n=_),4===I&&(n=S),5===I&&(n=A),6===I&&(n=d);for(var e=[],t=0;t<r.length;t++){var i=c({},r[t]),o=c({},r[t]),u=i.x,a=i.y,f=i.z;i.x=n[0][3]+n[0][0]*u+n[0][1]*a+n[0][2]*f,i.y=n[1][3]+n[1][0]*u+n[1][1]*a+n[1][2]*f,i.z=n[2][3]+n[2][0]*u+n[2][1]*a+n[2][2]*f,o.x=i.x,o.y=i.y,o.z=i.z,B.push(i),e.push(o)}Q.push(e),I++})),e&&(l=Q,h=X),B}function O(){return{atoms:l,letters:h}}var j=["SEQRES   1 A    1  A\nATOM      1  C1'   A A   1      -2.479   5.346   0.000\nATOM      2  N9    A A   1      -1.291   4.498   0.000\nATOM      3  C8    A A   1       0.024   4.897   0.000\nATOM      4  N7    A A   1       0.877   3.902   0.000\nATOM      5  C5    A A   1       0.071   2.771   0.000\nATOM      6  C6    A A   1       0.369   1.398   0.000\nATOM      7  N6    A A   1       1.611   0.909   0.000\nATOM      8  N1    A A   1      -0.668   0.532   0.000\nATOM      9  C2    A A   1      -1.912   1.023   0.000\nATOM     10  N3    A A   1      -2.320   2.290   0.000\nATOM     11  C4    A A   1      -1.267   3.124   0.000\nEND","SEQRES   1 A    1  G\nATOM      1  C1'   G A   1      -2.477   5.399   0.000\nATOM      2  N9    G A   1      -1.289   4.551   0.000\nATOM      3  C8    G A   1       0.023   4.962   0.000\nATOM      4  N7    G A   1       0.870   3.969   0.000\nATOM      5  C5    G A   1       0.071   2.833   0.000\nATOM      6  C6    G A   1       0.424   1.460   0.000\nATOM      7  O6    G A   1       1.554   0.955   0.000\nATOM      8  N1    G A   1      -0.700   0.641   0.000\nATOM      9  C2    G A   1      -1.999   1.087   0.000\nATOM     10  N2    G A   1      -2.949   0.139  -0.001\nATOM     11  N3    G A   1      -2.342   2.364   0.001\nATOM     12  C4    G A   1      -1.265   3.177   0.000\nEND","SEQRES   1 A    1  T\nATOM      1  C1'   T A   1      -2.481   5.354   0.000\nATOM      2  N1    T A   1      -1.284   4.500   0.000\nATOM      3  C2    T A   1      -1.462   3.135   0.000\nATOM      4  O2    T A   1      -2.562   2.608   0.000\nATOM      5  N3    T A   1      -0.298   2.407   0.000\nATOM      6  C4    T A   1       0.994   2.897   0.000\nATOM      7  O4    T A   1       1.944   2.119   0.000\nATOM      8  C5    T A   1       1.106   4.338   0.000\nATOM      9  C7    T A   1       2.466   4.961   0.001\nATOM     10  C6    T A   1      -0.024   5.057   0.000\nEND","SEQRES   1 A    1  C\nATOM      1  C1'   C A   1      -2.477   5.402   0.000\nATOM      2  N1    C A   1      -1.287   4.523   0.000\nATOM      3  C2    C A   1      -1.477   3.143   0.000\nATOM      4  O2    C A   1      -2.623   2.684   0.001\nATOM      5  N3    C A   1      -0.385   2.335   0.000\nATOM      6  C4    C A   1       0.849   2.855   0.000\nATOM      7  N4    C A   1       1.883   2.020   0.001\nATOM      8  C5    C A   1       1.065   4.271   0.000\nATOM      9  C6    C A   1      -0.038   5.062   0.000\nEND","SEQRES   1 A    1  A\nATOM      1  O3'   A A   1       0.000  -0.929  -1.315\nATOM      2  P     A A   1       0.000   0.000   0.000\nATOM      3  OP1   A A   1      -1.208   0.854  -0.000\nATOM      4  OP2   A A   1       1.208   0.854   0.000\nATOM      5  O5'   A A   1       0.000  -0.930   1.315\nEND"],k=[],S=[],_=[];function C(r){var n,e,t,i,o,u,c,a,f,s,m,h=[0,0,0,0,0,0],l=Math.PI;return(n=r[2][2])>1?n=1:n<-1&&(n=-1),e=Math.acos(n),o=r[1][1]*r[0][2]-r[0][1]*r[1][2],t=(i=0===e?-Math.atan2(r[0][1],r[1][1]):Math.atan2(r[2][1]*r[0][2]+o*r[1][2],o*r[0][2]-r[2][1]*r[1][2]))/2-Math.atan2(r[1][2],r[0][2]),h[0]=e*Math.sin(t)*180/l,h[1]=e*Math.cos(t)*180/l,h[2]=180*i/l,u=Math.sin(i/2-t),c=Math.cos(i/2-t),a=Math.sin(t),f=Math.cos(t),s=Math.sin(e/2),m=Math.cos(e/2),h[3]=(c*m*f-u*a)*r[0][3]+(u*m*f+c*a)*r[1][3]-s*f*r[2][3],h[4]=(-c*m*a-u*f)*r[0][3]+(-u*m*a+c*f)*r[1][3]+s*a*r[2][3],h[5]=c*s*r[0][3]+u*s*r[1][3]+m*r[2][3],h}function N(r){var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,1]],e=Math.PI,t=r[0]*e/180,i=r[1]*e/180,o=r[2]*e/180,u=.5*Math.sqrt(t*t+i*i),c=Math.atan2(t,i),a=o,f=Math.sin(c),s=Math.cos(c),m=Math.sin(a/2-c),h=Math.cos(a/2-c),l=Math.sin(u),p=Math.cos(u);return n[0][0]=h*p*s-m*f,n[0][1]=-h*p*f-m*s,n[0][2]=h*l,n[1][0]=m*p*s+h*f,n[1][1]=-m*p*f+h*s,n[1][2]=m*l,n[2][0]=-l*s,n[2][1]=l*f,n[2][2]=p,n[0][3]=0,n[1][3]=0,n[2][3]=0,f=Math.sin(c),s=Math.cos(c),l=Math.sin(u/2),p=Math.cos(u/2),n[0][3]=(r[3]*(h*p*s-m*f)+r[4]*(-h*p*f-m*s)+r[5]*(h*l))/2,n[1][3]=(r[3]*(m*p*s+h*f)+r[4]*(-m*p*f+h*s)+r[5]*(m*l))/2,n[2][3]=(r[3]*(-l*s)+r[4]*(l*f)+r[5]*p)/2,n}function P(r){for(var n=0,e=0,t=0,i=0;i<r.length;i++)n+=r[i][0],e+=r[i][1],t+=r[i][2];return[n/r.length,e/r.length,t/r.length]}function q(r){var n=[];n.length=r.length;for(var e=0;e<r.length;e++){n[e]=[],n[e].length=r[e].length;for(var t=0;t<r[e].length;t++)n[e][t]=r[e][t]}return n}function V(r,n){for(var e=0;e<n.length;e++)n[e][0]+=r[0],n[e][1]+=r[1],n[e][2]+=r[2]}function E(r,n){var e=P(r),t=P(n);e[0]=-e[0],e[1]=-e[1],e[2]=-e[2],t[0]=-t[0],t[1]=-t[1],t[2]=-t[2];var o=q(r);V(e,o);var u=q(n);V(t,u);var c,a=i.a.dot(i.a.transpose(u),o),f=i.a.svd(a),s=q(f.U),m=i.a.transpose(s),h=q(f.V),l=q(f.V),p=i.a.dot(h,m),y=i.a.transpose(p);i.a.det(y)<0&&((h=l)[2][0]=-h[2][0],h[2][1]=-h[2][1],h[2][2]=-h[2][2],c=i.a.transpose(h),p=i.a.dot(c,m),y=i.a.transpose(p)),c=i.a.dot([t],y);var g=[e[0]-c[0][0],e[1]-c[0][1],e[2]-c[0][2]],d=[];return d.length=4,y=i.a.transpose(y),d[0]=[y[0][0],y[0][1],y[0][2],-g[0]],d[1]=[y[1][0],y[1][1],y[1][2],-g[1]],d[2]=[y[2][0],y[2][1],y[2][2],-g[2]],d[3]=[0,0,0,1],d}function F(r){var n=r.atoms;if(0!==n.length){for(var e=r.letters,t=function(){var r=0,n={};return["A","G","T","C"].forEach((function(e){for(var t=j[r].split("\n"),i=[],o=1;o<t.length-1;o++){var u={};u.name=t[o].charAt(13)+(" "!==t[o].charAt(14)?t[o].charAt(14):"")+(" "!==t[o].charAt(15)?t[o].charAt(15):""),u.x=parseFloat(t[o].substring(30,38)),u.y=parseFloat(t[o].substring(38,46)),u.z=parseFloat(t[o].substring(46,54)),i.push(u)}r++,n[e]=i})),n}(),i=[],o=[],u=[],c=[],a=[],f=[],s=[],m=[],h=0;h<n[0].length;h++)for(var l=0;l<t[e[0]].length;l++)n[0][h].name===t[e[0]][l].name&&(i.push([n[0][h].x,n[0][h].y,n[0][h].z]),a.push([t[e[0]][l].x,t[e[0]][l].y,t[e[0]][l].z]));for(var p=0;p<n[2].length;p++)for(var y=0;y<t[e[2]].length;y++)n[2][p].name===t[e[2]][y].name&&(o.push([n[2][p].x,n[2][p].y,n[2][p].z]),f.push([t[e[2]][y].x,t[e[2]][y].y,t[e[2]][y].z]));for(var g=0;g<n[3].length;g++)for(var d=0;d<t[e[3]].length;d++)n[3][g].name===t[e[3]][d].name&&(c.push([n[3][g].x,n[3][g].y,n[3][g].z]),m.push([t[e[3]][d].x,t[e[3]][d].y,t[e[3]][d].z]));for(var v=0;v<n[5].length;v++)for(var A=0;A<t[e[5]].length;A++)n[5][v].name===t[e[5]][A].name&&(u.push([n[5][v].x,n[5][v].y,n[5][v].z]),s.push([t[e[5]][A].x,t[e[5]][A].y,t[e[5]][A].z]));return[E(i,a),E(u,s),E(o,f),E(c,m)]}}function D(r,n,e){for(var t=0;t<e.length;t++)r[t][n]=e[t]}function L(r){var n=F(r);if(n){var e=q(n[0]),t=q(n[1]),o=(q(e),q(e)),u=[t[0][1],t[1][1],t[2][1]],c=[e[0][2],e[1][2],e[2][2]],a=[t[0][2],t[1][2],t[2][2]];if(c[0]*a[0]+c[1]*a[1]+c[2]*a[2]<0){for(var f=0;f<3;f++)u[f]=-u[f],a[f]=-a[f];D(t,1,u),D(t,2,a)}var s=C(i.a.dot(i.a.inv(t),o));k=s;var m=[0,0],h=N(s);if(m[0]=q(i.a.dot(t,h)),e=q(n[2]),t=q(n[3]),q(e),o=q(e),u=[t[0][1],t[1][1],t[2][1]],a=[t[0][2],t[1][2],t[2][2]],(c=[e[0][2],e[1][2],e[2][2]])[0]*a[0]+c[1]*a[1]+c[2]*a[2]<0){for(var l=0;l<3;l++)u[l]=-u[l],a[l]=-a[l];D(t,1,u),D(t,2,a)}return h=N(s=C(i.a.dot(i.a.inv(t),o))),S=s,m[1]=q(i.a.dot(t,h)),_=C(i.a.dot(i.a.inv(m[0]),m[1])),N(_),m}}let U=[];function R(r,n){(r<-2.5||r>2.5)&&console.log(r),r+=5,r*=10,n[parseInt(r)]++}function G(r){let n=[];for(let e=0;e<100;e++)n.push([(e-50)/10+.05,r[e]]);return n}function I(r,n,e=!1){r>-1.5&&console.log("significant watson px (\xc5) = "+r),e?(r*=10,n[parseInt(r)]++):(r+=6,r*=10,n[parseInt(r)]++)}function B(r,n,e=!1){e?(r+=12,r*=10,n[parseInt(r)]++):(r-=6,r*=10,n[parseInt(r)]++)}function Q(r,n){r-=15,r*=2.5,n[parseInt(r)]++}function X(r,n){r<-2&&console.log("SLIDE: "+r),r+=4,r*=10,n[parseInt(r)]++}function z(){let r=U.cov,n=function(r){if(r.length!==r[0].length)return null;var n,e,t,i,o,u,c,a,f,s,m,h,l=[],p=[];for(t=0;t<r.length;t++){var y=[],g=[];for(i=0;i<r.length;i++)t===i?y.push(1):y.push(0),g.push(r[t][i]);l.push(g),p.push(y)}var d=[],v=[],A=[];for(t=0;t<r.length;t++)d.push(0),v.push(0),A.push(0);for(n=0;n<r.length;n++)A[n]=l[n][n],d[n]=A[n],v[n]=0;for(t=0;t<500;t++){for(a=0,n=0;n<r.length-1;n++)for(e=n+1;e<r.length;e++)a+=Math.abs(l[n][e]);if(0===a)return{eigenvectors:p,eigenvalues:A};for(n=0;n<r.length-1;n++)for(e=n+1;e<r.length;e++)if(m=100*Math.abs(l[n][e]),Math.abs(l[n][e])>0){for(s=A[e]-A[n],Math.abs(s)+m===Math.abs(s)?c=0!==s?l[n][e]/s:0:(o=0!==l[n][e]?.5*s/l[n][e]:0,c=1/(Math.abs(o)+Math.sqrt(1+o*o)),o<0&&(c=-c)),u=(f=c*(h=1/Math.sqrt(1+c*c)))/(1+h),s=c*l[n][e],v[n]-=s,v[e]+=s,A[n]-=s,A[e]+=s,l[n][e]=0,i=0;i<=n-1;i++)m=l[i][n],s=l[i][e],l[i][n]=m-f*(s+m*u),l[i][e]=s+f*(m-s*u);for(i=n+1;i<=e-1;i++)m=l[n][i],s=l[i][e],l[n][i]=m-f*(s+m*u),l[i][e]=s+f*(m-s*u);for(i=e+1;i<r.length;i++)m=l[n][i],s=l[e][i],l[n][i]=m-f*(s+m*u),l[e][i]=s+f*(m-s*u);for(i=0;i<r.length;i++)m=p[i][n],s=p[i][e],p[i][n]=m-f*(s+m*u),p[i][e]=s+f*(m-s*u)}for(n=0;n<r.length;n++)d[n]+=v[n],A[n]=d[n],v[n]=0}return console.log("could not solve eigenvectors of matrix in 500 iterations"),null}(i.a.inv(r)),e=[[]];e[0].length=30;for(let i=0;i<30;i++)e[0][i]=1/Math.sqrt(n.eigenvalues[i]);let t=[U.mean],o=i.a.identity(4);for(let i=0;i<4;i++)o[i][i]=0;let u=[[]];u[0].length=30;let c=[];c.length=30;let a=[],f=[],m=[],h=[],l=[],p=[],g=[],d=[];f.length=100,m.length=100,l.length=100,p.length=100,h.length=80,g.length=60,d.length=60;for(let i=0;i<100;i++)p[i]=0,l[i]=0,f[i]=0,m[i]=0,i<60&&(d[i]=0),i<60&&(g[i]=0),i<80&&(h[i]=0);for(let P=0;P<parseInt(U.numSamples);P++){for(let n=0;n<30;n++)u[0][n]=e[0][n]*A();let r=i.a.add(i.a.transpose(i.a.dot(n.eigenvectors,i.a.transpose(u))),t);for(let n=0;n<30;n++)c[n]=r[0][n];w(c,U.tetramer,!0);let x=O().atoms[1][1],M=O().atoms[4][1];L(O());let b=[k,_,S],T=s,j=x.x-T[0][3],C=x.y-T[1][3],N=x.z-T[2][3],P=[j*T[0][0]+C*T[1][0]+N*T[2][0],j*T[0][1]+C*T[1][1]+N*T[2][1],j*T[0][2]+C*T[1][2]+N*T[2][2]];j=M.x-T[0][3],C=M.y-T[1][3],N=M.z-T[2][3];let q=[j*T[0][0]+C*T[1][0]+N*T[2][0],j*T[0][1]+C*T[1][1]+N*T[2][1],j*T[0][2]+C*T[1][2]+N*T[2][2]];R(P[2],l),I(P[0],g),B(P[1],d),R(q[2],p),v=b[1][1],v+=25,v*=2,f[parseInt(v)]++,Q(b[1][2],m),X(b[1][4],h),a.push(P);let V=y;o=i.a.add(o,V)}var v;o=i.a.mul(1/parseFloat(U.numSamples),o);for(let s=0;s<2e3;s++)o=i.a.dot(o,o);let x=G(l),M=G(p),b=function(r,n=!1){let e=[];for(let t=0;t<60;t++)n?e.push([t/10+.05,r[t]]):e.push([(t-60)/10+.05,r[t]]);return e}(g),T=function(r,n=!1){let e=[];for(let t=0;t<60;t++)n?e.push([t/10-12+.05,r[t]]):e.push([t/10+6+.05,r[t]]);return e}(d),j=function(r){let n=[];for(let e=0;e<100;e++)n.push([(e-50)/2+.25,r[e]]);return n}(f),C=function(r){let n=[];for(let e=0;e<100;e++)n.push([e/2.5+15+.2,r[e]]);return n}(m),N=function(r){let n=[];for(let e=0;e<80;e++)n.push([(e-40)/10+.05,r[e]]);return n}(h);return console.log(JSON.stringify(G(l))),console.log(JSON.stringify(G(p))),console.log(a),console.log(o[0][3]+" "+o[1][3]),[o[2][3],x,M,j,N,b,T,C]}onmessage=r=>{U=r.data;let n=z();postMessage(n)}}]);
//# sourceMappingURL=Persistence.worker.669334c6.worker.js.map